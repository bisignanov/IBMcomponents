import{y as ee,p as pe,j as I,q as Ft,D as ot,E as Rt,F as Xt,G as Gt}from"./settings-DrdbGLhD.js";import{r as h,R as Jt}from"./index-BwDkhjyp.js";import{useMDXComponents as $t}from"./index-DlpNa54Y.js";import"./chunk-HLWAVYOI-DkA-Va2A.js";import{e as Qt,i as Yt,C as Zt}from"./index-CeYEq9Lt.js";import{c as we}from"./deprecate-D9ms-jbM.js";import{O as vt,a as Ct}from"./index-3iDKb0iK.js";import{d as ie,a as ge,i as ct,h as en,b as tn,F as nn,s as Dt,u as rn,r as Xe}from"./useMultipleKeyTracking-FRJh6Za3.js";import{P as o}from"./index-Dk74W0Oi.js";import{u as Oe}from"./uuidv4-BQrI85uz.js";import{p as ze}from"./props-helper-D-fMQKH_.js";import{u as Ue}from"./usePreviousValue-DDnp_zt4.js";import{g as an}from"./devtools-B_UYo462.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-CJvxHwuA.js";import"./events-Bq7WR1mU.js";import"./index-BONylQH5.js";import"./iframe-Dn5BrwtG.js";import"../sb-preview/runtime.js";import"./react-18-Dd3bHtks.js";import"./extends-CCbyfPlC.js";import"./index-C2eUe6cH.js";import"./index-BjQFKvNH.js";import"./isSymbol-BZYRlrjc.js";import"./index-DrFu-skq.js";import"./Text-_TFgs5hl.js";import"./index-gKY8typL.js";import"./useAttachedMenu-BGzc4N1_.js";import"./bucket-11-S2aFzyL7.js";import"./wrapFocus-CuszVIVc.js";import"./mergeRefs-CTUecegF.js";import"./createClassWrapper-EbB2Yi8H.js";const sn=()=>{const[t,e]=h.useState(document.activeElement),a=()=>{e(document.activeElement)};return h.useEffect(()=>(document.addEventListener("focusin",a),()=>{document.removeEventListener("focusin",a)}),[]),t},Ie=t=>{const e=Math.max(t.point1.row,t.point2.row),a=Math.max(t.point1.column,t.point2.column),r=Math.min(t.point1.row,t.point2.row),s=Math.min(t.point1.column,t.point2.column);return{greatestRowIndex:e,greatestColumnIndex:a,lowestColumnIndex:s,lowestRowIndex:r}},it=({ref:t,area:e,blockClass:a,defaultColumn:r,selectionAreas:s,setSelectionAreas:p,setActiveCellInsideSelectionArea:c,visibleColumns:u})=>{const{lowestColumnIndex:i,lowestRowIndex:f,greatestColumnIndex:A,greatestRowIndex:b}=Ie(e);(b-f>0||A-i>0)&&(c(!0),t.current.querySelector(`.${a}__active-cell--highlight`).setAttribute("data-selection-id",e.matcher));let y=0;u.forEach((L,n)=>{n>=i&&n<=A&&(y+=(L==null?void 0:L.width)||(r==null?void 0:r.width))});const m=(document.querySelector(`[data-row-index="${e.point1.row}"][data-column-index="${e.point1.column}"]`)||document.querySelector(`.${a}__body--td`)).offsetHeight,g=m*(b-f+1),H=document.querySelector(`.${a}__list--container`).firstElementChild,N=H.querySelector(`[data-row-index="${f}"][data-column-index="${i}"]`),j={top:N?N.getBoundingClientRect().top-H.getBoundingClientRect().top:f===0?0:m*f,left:N?N.getBoundingClientRect().left-H.getBoundingClientRect().left:i===0?0+(r.rowHeaderWidth-4):r.width*i+(r.rowHeaderWidth-4)},w=document.querySelector(`[data-matcher-id="${e.matcher}"]`)||document.createElement("div");w.classList.add(`${a}__selection-area--element`),w.setAttribute("data-matcher-id",e.matcher),w.style.width=ee(y),w.style.height=ee(g),w.style.left=ee(j.left),w.style.top=ee(j.top),H.appendChild(w);const E=ie(s),_=E.findIndex(L=>L.matcher===e.matcher);E[_].areaCreated=!0,p(E)},Ge=(t,e,a)=>{const r=ie(e),s=[];r.forEach(c=>{var f,A,b,y;const u=Math.max((f=c.point1)==null?void 0:f[a],(A=c.point2)==null?void 0:A[a]),i=Math.min((b=c.point1)==null?void 0:b[a],(y=c.point2)==null?void 0:y[a]);for(let l=i;l<=u;l++)s.push(l)});const p=[...new Set(s)];return!!(r!=null&&r.length&&p.includes(t))},qt=(t,e,a,r)=>ie(e).some(c=>{var l,m,g,H,N,j,w,E;const u=a==="column"?"row":"column",i=Math.min((l=c==null?void 0:c.point1)==null?void 0:l[u],(m=c==null?void 0:c.point2)==null?void 0:m[u]),f=Math.max((g=c==null?void 0:c.point1)==null?void 0:g[u],(H=c==null?void 0:c.point2)==null?void 0:H[u]),A=Math.min((N=c==null?void 0:c.point1)==null?void 0:N[a],(j=c==null?void 0:c.point2)==null?void 0:j[a]),b=Math.max((w=c==null?void 0:c.point1)==null?void 0:w[a],(E=c==null?void 0:c.point2)==null?void 0:E[a]),y=(r==null?void 0:r.length)-1===f&&i===0;for(let _=A;_<=b;_++)if(t===_&&y)return!0;return!1}),Mt=({type:t,headerGroup:e,scrollBarSizeValue:a,totalVisibleColumns:r,defaultColumn:s,totalColumnsWidth:p,visibleColumns:c})=>{const u=a+s.rowHeaderWidth;if(!r){if(t==="header")return ee(parseInt(e.getHeaderGroupProps().style.width)+u);if(t!=="header")return p+u}if(r)return c.map((f,A)=>A<=r-1&&((f==null?void 0:f.width)||(s==null?void 0:s.width))).reduce((f,A)=>f+A,0)+u},on=({spreadsheetRef:t,activeCellCoordinates:e,containerHasFocus:a,createActiveCell:r,activeCellContent:s,isActiveHeaderCellChanged:p})=>{let c;h.useEffect(()=>{c()},[s,c,p]),c=h.useCallback(()=>{const u=t==null?void 0:t.current.querySelector(`[data-row-index="${e==null?void 0:e.row}"][data-column-index="${e==null?void 0:e.column}"]`),i=(e==null?void 0:e.row)==="header"&&!0,f=t==null?void 0:t.current.querySelector('[data-row-index="header"][data-column-index="header"]');a&&r({placementElement:e?u:f,coords:e,addToHeader:i})},[t,e,a,r])},cn=({blockClass:t=`${pe.prefix}--data-spreadsheet`,focusedElement:e,removeActiveCell:a,setContainerHasFocus:r})=>{h.useEffect(()=>{e.classList.contains(`${t}--interactive-cell-element`)||(r(!1),a()),(e.classList.contains(t)||e.classList.contains(`${t}--interactive-cell-element`))&&r(!0)},[e,a,t,r])},un=({isBlurSpreadsheet:t,spreadsheetRef:e,blockClass:a=`${pe.prefix}--data-spreadsheet`,setActiveCellCoordinates:r,setSelectionAreas:s,removeActiveCell:p,setContainerHasFocus:c,removeCellEditor:u})=>{h.useEffect(()=>{const i=f=>{!e.current||e.current.contains(f.target)||f.target.classList.contains(`${a}__active-cell--highlight`)||f.target.classList.contains(`${a}--interactive-cell-element`)||(t.current=!0,r(null),s([]),p(),ge({spreadsheetRef:e}),c(!1))};return document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}},[t,e,p,a,r,c,s,u])},ln=({isEditing:t,rows:e,activeCellCoordinates:a,activeCellRef:r,cellEditorRef:s,cellEditorRulerRef:p,visibleColumns:c,defaultColumn:u,cellEditorValue:i,blockClass:f=`${pe.prefix}--data-spreadsheet`})=>{const[A,b]=h.useState(null),y=Ue({nextIndex:A});h.useEffect(()=>{y!=null&&y.nextIndex||b(a==null?void 0:a.column)},[y==null?void 0:y.nextIndex,a]),h.useEffect(()=>{var g,H,N,j,w;const l=p.current.offsetWidth,m=parseInt(s.current.style.width);if(t){const E=(g=e[a==null?void 0:a.row])==null?void 0:g.cells[a==null?void 0:a.column],_=r==null?void 0:r.current.style.left,L=r==null?void 0:r.current.style.top;if(s.current.style.left=_,s.current.style.top=L,s.current.style.display="block",s.current.style.height=r==null?void 0:r.current.style.height,s.current.style.paddingTop=`${(parseInt(r==null?void 0:r.current.style.height)-16)/2-1}px`,s.current.style.textAlign=((H=E==null?void 0:E.column)==null?void 0:H.placement)==="right"?"right":"left",(N=s.current)==null||N.focus(),l<m){const n=((j=c[A])==null?void 0:j.width)||(u==null?void 0:u.width);l<m-n&&(s.current.style.width=ee(parseInt(s.current.style.width)-n),b(M=>M===0?M:M-1))}if(l>=m){b(O=>O===c.length-1?O:O+1);const M=A+1===c.length?0:((w=c[A+1])==null?void 0:w.width)||(u==null?void 0:u.width),D=a==null?void 0:a.row,Y=(e.length-D)*u.rowHeight;s.current.style.maxHeight=ee(Y),s.current.style.width=ee(M+m),s.current.style.height=ee(s.current.scrollHeight),s.current.clientHeight===Y-1?s.current.style.overflow="auto":s.current.style.overflow="hidden"}}t||(s.current.style.overflow="hidden",s.current.style.display="none",s.current.blur(),r.current.focus(),b(a==null?void 0:a.column))},[t,a,e,i,u,r,s,p,c,f,y==null?void 0:y.cellEditorValue,A])},mn=({currentMatcher:t,setSelectionAreas:e,selectedHeaderReorderActive:a,setSelectedHeaderReorderActive:r,setClickAndHoldActive:s,setValidStartingPoint:p,validStartingPoint:c,blockClass:u=`${pe.prefix}--data-spreadsheet`,ref:i,setHeaderCellHoldActive:f,setColumnOrder:A,visibleColumns:b,setActiveCellCoordinates:y,activeCellCoordinates:l,rows:m,defaultColumn:g,selectionAreas:H})=>{h.useEffect(()=>{const N=j=>{var E,_;let w=!1;if((E=H==null?void 0:H[0])!=null&&E.header&&H[0].header.type==="column"&&(w=!0),!c&&w){f(!1);const L=i.current.querySelector(`.${u}__selection-area--element`),n=i.current.querySelector(`.${u}__selection-area--element-cloned`);if(!n)return;if(n){const M=j.target.closest(`.${u}--interactive-cell-element`),D=parseInt==null?void 0:parseInt(M==null?void 0:M.getAttribute("data-column-index")),W=parseInt==null?void 0:parseInt(n==null?void 0:n.getAttribute("data-column-index-original")),O=H.filter(V=>(V==null?void 0:V.matcher)===t)[0].header.selectedIndexList;if(!i.current.querySelector(`[data-row-index="header"][data-column-index="${D}"]`))return;const U=i.current.querySelector(`[data-matcher-id="${t}"]`),P=i.current.getBoundingClientRect(),F=i.current.querySelector(`.${u}__list--container`).scrollLeft,$=D<W,ae=D>W,ue=ae?D-W:W-D;if(e(V=>{const v=ie(V);if(W===D)return V;const te=v.findIndex(Z=>Z.matcher===t);if(te===-1)return V;if(!O.includes(D)){const Z=ae?O.map(le=>le+ue):O.map(le=>le-ue);v[te].header.selectedIndexList=Z,v[te].point1.column=Math.min(...Z),v[te].point2.column=Math.max(...Z)}return v[te].areaCreated=!1,v}),!O.includes(D)){const V=O.length,v=Math.min(...O),te=b.map(k=>k.id),Z=[...te],le=()=>{const k=[];return O.map(z=>k.push(te[z])),k};Z.splice(v,V);const be=O.findIndex(k=>k===W),he=D-be;Z.splice(he,0,...le()),A(Z);const fe={...l,column:ae?l.column+ue:l.column-ue};y(fe);const d=Array.from(i.current.querySelectorAll(`.${u}__th--selected-header`))[0].getBoundingClientRect().left-P.left+F,B=$?d:D===W?U.style.left:d;U.style.left=ee(B)}const se=i.current.querySelector(`.${u}__reorder-indicator-line`);se==null||se.remove(),n==null||n.remove(),(_=L==null?void 0:L.classList)==null||_.remove(`${u}__selection-area--element`),r(!1)}}if(c||j.type==="mouseup"){s(!1),p(!1);const L=j.target.closest(`.${u}__body--td`);if(L){const n={row:Number(L.getAttribute("data-row-index")),column:Number(L.getAttribute("data-column-index"))};e(M=>{const D=ie(M),W=D.findIndex(Y=>Y.matcher===t);return W===-1?M:(D[W].point2=n,D[W].areaCreated=!1,D)})}}};return document.addEventListener("mouseup",N),()=>{document.removeEventListener("mouseup",N)}},[u,t,e,s,p,c,a,r,i,f,A,b,y,l,m,g,H])},dn=({blockClass:t=`${pe.prefix}--data-spreadsheet`,clonedSelectionElement:e,ref:a,spreadsheetCoords:r,leftScrollAmount:s})=>{const p=event.target.closest(`.${t}--interactive-cell-element`),c=p==null?void 0:p.getAttribute("data-column-index"),u=e==null?void 0:e.getAttribute("data-column-index-original"),i=p.getBoundingClientRect(),f=a.current.querySelector(`.${t}__reorder-indicator-line`),A=e==null?void 0:e.getAttribute("data-matcher-id"),b=a.current.querySelector(`[data-matcher-id="${A}"]`),y=a.current.querySelector(`.${t}__list--container`),l=10,m=120,g=100,{clientX:H}=event,{left:N,right:j}=y.getBoundingClientRect();if(H<m&&window.scrollBy(-l,0),H>window.innerWidth-g&&window.scrollBy(l,0),H>N&&H<N+m&&y.scrollBy(-l,0),H<j&&H>j-g&&y.scrollBy(l,0),Number(c)>Number(u)){const w=i.left-r.left+p.offsetWidth-2+s;f.style.left=ee(w)}if(Number(c)<Number(u)){const w=i.left-r.left+s;f.style.left=ee(w)}Number(c)===Number(u)&&(f.style.left=b.style.left)},hn=({ref:t,blockClass:e=`${pe.prefix}--data-spreadsheet`,headerCellHoldActive:a,defaultColumn:r})=>{h.useEffect(()=>{const s=c=>{const u=t.current.querySelector(`.${e}__selection-area--element-cloned`);u&&t.current.addEventListener("mousemove",s);const i=t.current.getBoundingClientRect(),f=t.current.querySelector(`.${e}__list--container`),A=f.scrollLeft;dn({clonedSelectionElement:u,ref:t,spreadsheetCoords:i,leftScrollAmount:A}),t.current.getBoundingClientRect();const y=c.clientX-i.left,l=u==null?void 0:u.getAttribute("data-clone-offset-x"),m=f.scrollWidth,g=u.offsetWidth,H=Math.max(y-l,r==null?void 0:r.rowHeaderWidth),N=m-g>=H?H+A:m-g;N<i.right-40&&(u.style.left=ee(N))};a&&t.current.addEventListener("mousemove",s);const p=t.current;return a||p==null||p.removeEventListener("mousemove",s),()=>{p==null||p.removeEventListener("mousemove",s)}})},ke=(t,e)=>e=="cmd"?t.metaKey||t.ctrlKey:t[e],pn=({indexList:t,newIndex:e,activeCellIndex:a})=>{const r=e>a?a:Math.min(...t,e),s=e<a?a:Math.max(...t,e),p=[];for(let c=r;c<=s;c++)p.push(c);return[...p]},Ee=({type:t,activeCellCoordinates:e,rows:a,columns:r,currentMatcher:s,setActiveCellCoordinates:p,setCurrentMatcher:c,setSelectionAreas:u,spreadsheetRef:i,index:f,isKeyboard:A,setSelectionAreaData:b,isHoldingCommandKey:y,isHoldingShiftKey:l})=>{y||(b([]),ge({spreadsheetRef:i}));const m=A?e==null?void 0:e.row:f,g=A?e==null?void 0:e.column:f,H={row:t==="column"?0:m,column:t==="column"?g:0},N={row:t==="column"?a.length-1:m,column:t==="column"?g:r.length-1},j=Oe();l||(p({row:t==="column"?0:m,column:t==="column"?g:0}),c(j));const w={point1:H,point2:N,areaCreated:!1,matcher:j,header:{type:t,selectedIndexList:[t==="column"?g:m]}};u(E=>{var L,n;const _=ie(E);if(y){const D=_.filter(Y=>{var O;return(O=Y.header)==null?void 0:O.type}).filter(Y=>{var O;return((O=Y.header)==null?void 0:O.type)===t}),W=Ge(f,D,t);return D.length&&W?E:[...E,w]}if(l){const D=_.filter($=>{var ae;return(ae=$.header)==null?void 0:ae.type}).filter($=>$.matcher===s)[0],W=Math.max(D==null?void 0:D.point1[t],D==null?void 0:D.point2[t],e==null?void 0:e[t]),Y=t==="column"?g:m,O={row:W<Y?a.length-1:0,column:g},q=ie(E),U=q.findIndex($=>$.matcher===s),P=pn({indexList:((n=(L=q[U])==null?void 0:L.header)==null?void 0:n.selectedIndexList)||[t==="column"?g:m],newIndex:Y,activeCellIndex:e==null?void 0:e[t]}),X=$=>$<Y?{row:t==="column"?0:Math.min(...P),column:t==="column"?Math.min(...P):0}:O,F=$=>$<Y?O:{row:t==="column"?a.length-1:Math.max(...P),column:t==="column"?Math.max(...P):r.length-1};if(!e||typeof e>"u"){c(j);const $={point1:X(t==="column"?g:m),point2:F(t==="column"?g:m),areaCreated:!1,matcher:j,header:{type:t,selectedIndexList:[t==="column"?g:m]}};return p({row:t==="column"?0:m,column:t==="column"?g:0}),[$]}return q[U].point1=X(e==null?void 0:e[t]),q[U].point2=F(e==null?void 0:e[t]),q[U].areaCreated=!1,q[U].header.selectedIndexList=P,q}return[w]})},fn=({activeCellInsideSelectionArea:t,activeCellCoordinates:e,activeCellRef:a,selectionAreas:r,updateActiveCellCoordinates:s})=>{if(!t)return;const p=a.current.getAttribute("data-selection-id"),c=r.findIndex(l=>l.matcher===p),u=r[c],{lowestColumnIndex:i,lowestRowIndex:f,greatestColumnIndex:A,greatestRowIndex:b}=Ie(u),y={...e};if((e==null?void 0:e.row)<b&&s({coords:y,updatedValue:{row:(y==null?void 0:y.row)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.row)===b&&((e==null?void 0:e.column)<A&&s({coords:y,updatedValue:{column:(y==null?void 0:y.column)+1,row:f},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.column)===A)){if(r.length>1)if(r[c+1]){a.current.setAttribute("data-selection-id",r[c+1].matcher);const l=r[c+1],{lowestColumnIndex:m,lowestRowIndex:g}=Ie(l);s({coords:y,updatedValue:{column:m,row:g},optOutOfSelectionAreaUpdate:!0});return}else{a.current.setAttribute("data-selection-id",r[0].matcher);const l=r[0],{lowestColumnIndex:m,lowestRowIndex:g}=Ie(l);s({coords:y,updatedValue:{column:m,row:g},optOutOfSelectionAreaUpdate:!0})}if(r.length===1)return s({coords:y,updatedValue:{column:i,row:f},optOutOfSelectionAreaUpdate:!0})}},wn=({activeCellInsideSelectionArea:t,activeCellCoordinates:e,activeCellRef:a,selectionAreas:r,updateActiveCellCoordinates:s})=>{if(!t)return;const p=a.current.getAttribute("data-selection-id"),c=r.findIndex(y=>y.matcher===p),u=r[c],{lowestColumnIndex:i,lowestRowIndex:f,greatestColumnIndex:A,greatestRowIndex:b}=Ie(u);if((e==null?void 0:e.column)<A&&s({updatedValue:{column:(e==null?void 0:e.column)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.column)===A&&((e==null?void 0:e.row)<b&&s({updatedValue:{column:i,row:(e==null?void 0:e.row)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.row)===b)){if(r.length>1)if(r[c+1]){a.current.setAttribute("data-selection-id",r[c+1].matcher);const y=r[c+1],{lowestColumnIndex:l,lowestRowIndex:m}=Ie(y);s({updatedValue:{column:l,row:m},optOutOfSelectionAreaUpdate:!0});return}else{a.current.setAttribute("data-selection-id",r[0].matcher);const y=r[0],{lowestColumnIndex:l,lowestRowIndex:m}=Ie(y);s({updatedValue:{column:l,row:m},optOutOfSelectionAreaUpdate:!0})}if(r.length===1)return s({updatedValue:{column:i,row:f},optOutOfSelectionAreaUpdate:!0})}},ut=(t,e,a)=>{for(let r=t;r<=e;r++)a(r)},yn=({activeCellCoordinates:t,selectionAreas:e,currentMatcher:a,rows:r,setActiveCellContent:s,updateData:p})=>{var l,m,g,H,N,j,w,E;if((t==null?void 0:t.column)==="header"||(t==null?void 0:t.row)==="header")return;const c=ie(e),u=c.findIndex(_=>_.matcher===a),i=c[u],f=Math.min((l=i==null?void 0:i.point1)==null?void 0:l.column,(m=i==null?void 0:i.point2)==null?void 0:m.column),A=Math.max((g=i==null?void 0:i.point1)==null?void 0:g.column,(H=i==null?void 0:i.point2)==null?void 0:H.column),b=Math.min((N=i==null?void 0:i.point1)==null?void 0:N.row,(j=i==null?void 0:i.point2)==null?void 0:j.row),y=Math.max((w=i==null?void 0:i.point1)==null?void 0:w.row,(E=i==null?void 0:i.point2)==null?void 0:E.row);ut(f,A,_=>{ut(b,y,L=>{const n=r[L].cells[_];p(L,n==null?void 0:n.column.id,"")})}),s(null)},Be=`${pe.prefix}--data-spreadsheet`,gn=(t,e,a,...r)=>{const[s,p,c,u,i,f,A,b,y,l,m,g,H]=r;a.preventDefault();const j=a.target.closest(`.${Be}__body--td`).classList.contains(`${Be}__body--td`);H(j);const w=ke(a,"cmd"),E=ke(a,"shiftKey");f(!0);const _={row:t.row.index,column:e},L=Oe();if(A(!0),w)y.current.querySelector(`.${Be}__active-cell--highlight`).setAttribute("data-selection-id",L),m(!0),u(_),b(L),i(M=>[...M,{point1:_,matcher:L}]);else if(E){f(!0);const n=ie(c),M=n.findIndex(D=>D.matcher===s);if(M===-1)return;n[M].point1=p,n[M].point2=_,n[M].areaCreated=!1,n[M].matcher=s,i(n)}else g.current.style.display="none",m(!1),u(_),ge({spreadsheetRef:y}),i([{point1:_,matcher:L}]),b(L),l([])},bn=(t,e,...a)=>{const[r,s,p]=a;if(r){const c={row:t.row.index,column:e};p(u=>{var A,b;const i=ie(u),f=i.findIndex(y=>y.matcher===s);return f===-1||((A=i[f].point2)==null?void 0:A.row)===c.row&&((b=i[f].point2)==null?void 0:b.column)===c.column?u:(i[f].point2=c,i[f].areaCreated=!1,i)})}},xn=(t,e,...a)=>{const[r,s,p,c,u,i,f,A]=a,b=ke(e,"cmd");Ee({type:"row",activeCellCoordinates:i,rows:f,columns:r,setActiveCellCoordinates:u,setCurrentMatcher:c,setSelectionAreas:p,spreadsheetRef:s,index:t,setSelectionAreaData:A,isHoldingCommandKey:b})},Sn=(t,...e)=>{const[a,r,s,p,c,u,i,f,A,b,y,l,m,g,H,N,j,w,E,_,L,n,M]=e,{key:D}=t;if(!H(D)&&(["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(D)>-1&&b!=null&&b.length&&l.length<2&&!ct(l)&&(j([]),w([]),ge({spreadsheetRef:i})),(l==null?void 0:l.length)>1&&en({activeCellCoordinates:s,event:t,keysPressedList:l,selectionAreas:b,currentMatcher:f,rows:u,setSelectionAreas:j,columns:c,updateActiveCellCoordinates:r,spreadsheetRef:i,removeCellSelections:ge,blockClass:Be,setCurrentMatcher:E,usingMac:m}),l.length<2&&!ct(l)||s.row==="header"||s.column==="header"))switch(D){case"Backspace":case"Delete":{yn({selectionAreas:b,currentMatcher:f,rows:u,setActiveCellContent:M,updateData:g,activeCellCoordinates:s});break}case"Enter":{fn({activeCellInsideSelectionArea:a,activeCellCoordinates:s,activeCellRef:_,selectionAreas:b,updateActiveCellCoordinates:r});break}case"Home":case"End":{if(t.preventDefault(),tn(l,m))return;y({type:D});break}case"Tab":{if(a)return t.preventDefault(),wn({activeCellInsideSelectionArea:a,activeCellCoordinates:s,activeCellRef:_,selectionAreas:b,updateActiveCellCoordinates:r});j([]),p(),A(),n(!1),L(null);break}case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":N(D)}},R=`${pe.prefix}--data-spreadsheet`,Je=h.forwardRef(({activeCellRef:t,columns:e,activeCellCoordinates:a,defaultColumn:r,defaultEmptyRowCount:s,getTableBodyProps:p,headerGroups:c,id:u,onDataUpdate:i,renderRowHeader:f,renderRowHeaderDirection:A,hasCustomRowHeader:b,prepareRow:y,rows:l,selectionAreaData:m,setSelectionAreaData:g,setActiveCellCoordinates:H,selectedHeaderReorderActive:N,setSelectedHeaderReorderActive:j,selectionAreas:w,setContainerHasFocus:E,setSelectionAreas:_,scrollBarSize:L,totalColumnsWidth:n,clickAndHoldActive:M,setClickAndHoldActive:D,currentMatcher:W,setCurrentMatcher:Y,onSelectionAreaChange:O,setActiveCellInsideSelectionArea:q,totalVisibleColumns:U,setHeaderCellHoldActive:P,setColumnOrder:X,visibleColumns:F},$)=>{const[ae,ue]=h.useState(!1),se=h.useRef(),V=Ue({selectionAreaData:m,clickAndHoldActive:M,rowHeight:r==null?void 0:r.rowHeight})||{};h.useEffect(()=>{$==null||$.current.style.setProperty(`--${R}--total-width`,ee((n||0)+(L||0)))},[$,L,n]),h.useEffect(()=>{var d,B,k,z;if(m!=null&&m.length){let T=!1;(((d=V==null?void 0:V.selectionAreaData)==null?void 0:d.length)!==(m==null?void 0:m.length)||((B=m==null?void 0:m[0])==null?void 0:B.cells.length)!==((z=(k=V==null?void 0:V.selectionAreaData)==null?void 0:k[0])==null?void 0:z.cells.length))&&(T=!0),(!M&&(V!=null&&V.clickAndHoldActive)||T)&&(O==null||O(m))}},[V==null?void 0:V.selectionAreaData,m,O,M,V==null?void 0:V.clickAndHoldActive]),h.useEffect(()=>{w&&w.length&&w.map(d=>{if(d.areaCreated){const B=Math.min(d.point1.row,d.point2.row),k=Math.max(d.point1.row,d.point2.row),z=Math.min(d.point1.column,d.point2.column),T=Math.max(d.point1.column,d.point2.column),J={rows:{start:B,end:k},columns:{start:z,end:T},cells:v({rowStart:B,rowEnd:k,columnStart:z,columnEnd:T}),selectionId:d.matcher};g==null||g(me=>[...ie(me).filter(Pe=>Pe.selectionId!==d.matcher),J])}!d.areaCreated&&d.point1&&d.point2&&d.matcher&&it({ref:$,area:d,blockClass:R,defaultColumn:r,selectionAreas:w,setSelectionAreas:_,setActiveCellInsideSelectionArea:q,visibleColumns:F})})},[w,_,r,O,g,$,a,q,F,b]);const v=({rowStart:d,rowEnd:B,columnStart:k,columnEnd:z})=>{const T=[];for(let J=d;J<=B;J++)for(let me=k;me<=z;me++)T.push([J,me,`${R}__cell--${J}--${me}`]);return T};mn({currentMatcher:W,setClickAndHoldActive:D,setSelectionAreas:_,setValidStartingPoint:ue,selectedHeaderReorderActive:N,setSelectedHeaderReorderActive:j,validStartingPoint:ae,ref:$,setHeaderCellHoldActive:P,setColumnOrder:X,visibleColumns:F,setActiveCellCoordinates:H,rows:l,activeCellCoordinates:a,defaultColumn:r,selectionAreas:w}),h.useEffect(()=>{let d,B;if(ce!=null&&ce.current&&(d=ce==null?void 0:ce.current,B=d==null?void 0:d.querySelector(`.${R}__active-cell--highlight`)),B&&(r==null?void 0:r.rowHeight)!==V.rowHeight&&(B.style.height=`${r==null?void 0:r.rowHeight}px`,a)){const k=$==null?void 0:$.current.querySelector(`[data-row-index="${a.row}"][data-column-index="${a.column}"]`),z=$==null?void 0:$.current.querySelector(`.${R}__list--container`);let T;k&&z&&(T=(k==null?void 0:k.getBoundingClientRect().top)-z.getBoundingClientRect().top),B.style.top=ee(T),ge({matcher:void 0,spreadsheetRef:$}),w==null||w.map(J=>{if(!J.areaCreated&&J.point1&&J.point2&&J.matcher)return it({ref:$,area:J,blockClass:R,defaultColumn:r,selectionAreas:w,setSelectionAreas:_,setActiveCellInsideSelectionArea:q,visibleColumns:F})})}},[r,$,a,V==null?void 0:V.rowHeight,w,q,_,F,b]);const te=h.useCallback(()=>{const d=[],B=[];$==null||$.current.querySelectorAll(`.${R}__selection-area--element`).forEach(k=>{const{top:z,left:T,height:J,width:me}=k.style,de=`${z}${T}${J}${me}`;d.indexOf(de)==-1?d.push(de):(k.remove(),B.push(k.getAttribute("data-matcher-id")))}),B.length&&(_==null||_(k=>ie(k).filter(T=>!B.includes(T.matcher))),g==null||g(k=>ie(k).filter(T=>!B.includes(T.selectionId))))},[$,_,g]);h.useEffect(()=>{te()},[w,te]);const Z=h.useCallback((d,B)=>k=>{gn(d,B,k,W,a,w,H,_,E,D,Y,$,g,q,t,ue)},[W,a,w,H,_,E,D,Y,$,g,q,t]),le=()=>{const d=$.current.querySelector(`
        .${R}__header--container .${R}__tr`)||new HTMLDivElement;d.scrollLeft=se==null?void 0:se.current.scrollLeft};h.useEffect(()=>{se.current.addEventListener("scroll",()=>le());const d=se.current||new HTMLElement;return()=>{d.removeEventListener("scroll",le)}});const be=h.useCallback((d,B)=>()=>{bn(d,B,M,W,_)},[M,W,_]),he=h.useCallback(d=>B=>{xn(d,B,e,$,_,Y,H,a,l,g)},[e,$,_,Y,H,a,l,g]);h.useEffect(()=>{l!=null&&l.length||(()=>{const B=[];[...Array(s)].map(()=>{var z;const k={};(z=c==null?void 0:c[0])==null||z.headers.map(T=>{k[T.id]=null}),B.push(k)}),i==null||i(B)})()},[l,c,s,i]);const fe=()=>I.jsx("div",{}),G=h.useCallback(({index:d,style:B})=>{const k=l==null?void 0:l[d];if(l&&l.length){y==null||y(k);const z=ze(k.getRowProps({style:B}),"key");return I.jsxs("div",{...z,className:we(`${R}__tr`),"data-row-index":d,"aria-rowindex":d+1,"aria-owns":`${R}__cell-editor-text-area`,children:[I.jsx("div",{role:"rowheader",className:`${R}__td-th--cell-container`,children:I.jsxs("button",{id:`${R}__cell--${d}--header`,tabIndex:-1,"data-row-index":d,"data-column-index":"header",type:"button",onClick:he(d),className:we(`${R}__td`,`${R}__td-th`,`${R}--interactive-cell-element`,{[`${R}__td_custom`]:!!b,[`${R}__td-th--active-header`]:!b&&((a==null?void 0:a.row)===d||Ge(d,w,"row")),[`${R}__td-th--selected-header`]:!b&&qt(d,w,"row",e)}),style:{width:r==null?void 0:r.rowHeaderWidth,flexDirection:b?A==="Left"?"row-reverse":k:void 0},children:[d+1,b&&typeof f=="function"&&f(d)]})}),k.cells.map((T,J)=>{var de;const me=ze(T.getCellProps(),"key");return I.jsx("div",{"aria-colindex":J+1,...me,role:"gridcell",style:{...T.getCellProps().style,display:"grid",minWidth:((de=T==null?void 0:T.column)==null?void 0:de.width)||(r==null?void 0:r.width)},children:I.jsx("button",{id:`${R}__cell--${T.row.index}--${J}`,tabIndex:-1,"data-row-index":T.row.index,"data-column-index":J,className:we(`${R}__td`,`${R}__body--td`,`${R}--interactive-cell-element`),onMouseDown:Z(T,J),onMouseOver:be(T,J),onFocus:()=>{},type:"button",children:T.render("Cell")})},`cell_${J}`)})]},{...k.getRowProps().key})}},[y,f,A,l,b,a==null?void 0:a.row,w,he,Z,be,r,e]),ce=h.useRef();return I.jsx("div",{ref:ce,className:we(`${R}__body--container`),...p==null?void 0:p(),children:I.jsx(nn,{className:we(`${R}__list--container`,`${R}__list--container--${u}`),height:400,itemCount:(l==null?void 0:l.length)||s,itemSize:r==null?void 0:r.rowHeight,width:Mt({headerGroup:void 0,type:void 0,scrollBarSizeValue:L,totalVisibleColumns:U,defaultColumn:r,totalColumnsWidth:n,visibleColumns:F}),outerRef:se,children:l!=null&&l.length?G:fe})})});Je.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.string,o.number]),column:o.oneOfType([o.string,o.number])}),activeCellRef:o.object,clickAndHoldActive:o.bool,columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),defaultEmptyRowCount:o.number,getTableBodyProps:o.func,hasCustomRowHeader:o.bool,headerGroups:o.arrayOf(o.object),id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,prepareRow:o.func,renderRowHeader:o.func,renderRowHeaderDirection:o.string,rows:o.arrayOf(o.object),scrollBarSize:o.number,selectedHeaderReorderActive:o.bool,selectionAreaData:o.array,selectionAreas:o.array,setActiveCellCoordinates:o.func,setActiveCellInsideSelectionArea:o.func,setClickAndHoldActive:o.func,setColumnOrder:o.func,setContainerHasFocus:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalColumnsWidth:o.number,totalVisibleColumns:o.number,visibleColumns:o.array};Je.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetBody",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},column:{name:"union",value:[{name:"string"},{name:"number"}],required:!1}}}},activeCellRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"union",raw:"HTMLElement | undefined",elements:[{name:"HTMLElement"},{name:"undefined"}]}],raw:"MutableRefObject<HTMLElement | undefined>"},description:"This is the ref of the button input, which is the active cell element",type:{name:"object"}},clickAndHoldActive:{required:!1,tsType:{name:"boolean"},description:"Is the user clicking and holding in the data spreadsheet body",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"This represents the id of the current cell selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",type:{name:"number"}},getTableBodyProps:{required:!1,tsType:{name:"signature",type:"function",raw:"(propGetter?: TableBodyPropGetter<any>) => TableBodyProps",signature:{arguments:[{type:{name:"TableBodyPropGetter",elements:[{name:"any"}],raw:"TableBodyPropGetter<any>"},name:"propGetter"}],return:{name:"TableBodyProps"}}},description:"Function to set table body prop values",type:{name:"func"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",type:{name:"func"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if user is using custom component",type:{name:"bool"}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},renderRowHeaderDirection:{required:!1,tsType:{name:"string"},description:"Component next to numbering rows",type:{name:"string"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called to set the rows for the empty spreadsheet",type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called when the selection areas change",type:{name:"func"}},prepareRow:{required:!1,tsType:{name:"signature",type:"function",raw:"(...args) => void",signature:{arguments:[{name:"args",rest:!0}],return:{name:"void"}}},description:"Prepare row function from react-table",type:{name:"func"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectionAreaData:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection area data",type:{name:"array"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection areas",type:{name:"array"}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates state value",type:{name:"func"}},setActiveCellInsideSelectionArea:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for active cell inside of selection area",type:{name:"func"}},setClickAndHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for clickAndHold state value",type:{name:"func"}},setColumnOrder:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  updater:
    | ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
    | Array<IdType<any>>
) => void`,signature:{arguments:[{type:{name:"union",raw:`| ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
| Array<IdType<any>>`,elements:[{name:"unknown"},{name:"Array",elements:[{name:"IdType",elements:[{name:"any"}],raw:"IdType<any>"}],raw:"Array<IdType<any>>"}]},name:"updater"}],return:{name:"void"}}},description:"Setter fn for column ordering, provided from react-table",type:{name:"func"}},setContainerHasFocus:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for containerHasFocus state value",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher state value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas state value",type:{name:"func"}},totalColumnsWidth:{required:!1,tsType:{name:"number"},description:"The total columns width",type:{name:"number"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Prop from react-table used to reorder columns",type:{name:"array"}}}};const C=`${pe.prefix}--data-spreadsheet`,Qe=h.forwardRef(({activeCellCoordinates:t,cellSize:e,columns:a,currentMatcher:r,defaultColumn:s,headerGroups:p,scrollBarSize:c,selectionAreas:u,selectedHeaderReorderActive:i,setSelectedHeaderReorderActive:f,setActiveCellCoordinates:A,setCurrentMatcher:b,setSelectionAreas:y,setSelectionAreaData:l,rows:m,totalVisibleColumns:g,updateActiveCellCoordinates:H,setHeaderCellHoldActive:N,headerCellHoldActive:j,selectAllAriaLabel:w,visibleColumns:E},_)=>{const[L,n]=h.useState(0),M=Ue({cellSize:e})||{};h.useEffect(()=>{var O;if((M==null?void 0:M.cellSize)!==e){const q=(O=_==null?void 0:_.current)==null?void 0:O.querySelector(`.${C}__list--container`),P=(q==null?void 0:q.scrollHeight)&&(q==null?void 0:q.clientHeight)&&(q==null?void 0:q.scrollHeight)>(q==null?void 0:q.clientHeight)?0:c;q!=null&&q.getAttribute("tabIndex")||q==null||q.setAttribute("tabIndex","0"),n(P)}},[e,_,c,M==null?void 0:M.cellSize]);const D=O=>q=>{const U=ke(q,"cmd"),P=ke(q,"shiftKey");Ee({type:"column",activeCellCoordinates:t,rows:m,columns:a,currentMatcher:r,setActiveCellCoordinates:A,setCurrentMatcher:b,setSelectionAreas:y,spreadsheetRef:_,index:O,isKeyboard:void 0,setSelectionAreaData:l,isHoldingCommandKey:U,isHoldingShiftKey:P})},W=()=>{Dt({ref:_,setCurrentMatcher:b,setSelectionAreas:y,rows:m,columns:a,activeCellCoordinates:t,updateActiveCellCoordinates:H})},Y=O=>q=>{var le,be,he,fe,G,ce;if(q.shiftKey)return;const U=u==null?void 0:u.filter(d=>(d==null?void 0:d.matcher)===r),P=_.current.querySelector(`[data-matcher-id="${(le=U==null?void 0:U[0])==null?void 0:le.matcher}"]`);P&&P.classList.add(`${C}__selection-area--element`),typeof f=="function"&&f(!0);const X=q.clientX,F=q.target.getBoundingClientRect(),$=q.target.getAttribute("data-column-index"),ae=X-F.left,ue=Math.min(((he=(be=U==null?void 0:U[0])==null?void 0:be.point1)==null?void 0:he.column)||0,((G=(fe=U==null?void 0:U[0])==null?void 0:fe.point2)==null?void 0:G.column)||0),se=(P==null?void 0:P.getBoundingClientRect())||new DOMRect,V=ue<parseInt($)?ae+(F.left-(se==null?void 0:se.left)):ae,v=(ce=document==null?void 0:document.querySelector(`.${C}__list--container`))==null?void 0:ce.firstElementChild,te=P==null?void 0:P.cloneNode(),Z=P==null?void 0:P.cloneNode();Z&&(Z.className=`${C}__reorder-indicator-line`,Z.style.width=ee(2)),te.classList.add(`${C}__selection-area--element-cloned`),te.setAttribute("data-clone-offset-x",`${V}`),te.setAttribute("data-column-index-original",O),v==null||v.appendChild(te),v==null||v.appendChild(Z),N==null||N(!0)};return hn({ref:_,headerCellHoldActive:j,defaultColumn:s}),I.jsx("div",{className:we(`${C}__header--container`),role:"rowgroup",children:p==null?void 0:p.map((O,q)=>{const U=ze(O.getHeaderGroupProps(),"key");return I.jsxs("div",{...U,style:{...O.getHeaderGroupProps().style,width:Mt({type:"header",headerGroup:O,scrollBarSizeValue:L,totalVisibleColumns:g,defaultColumn:s,totalColumnsWidth:void 0,visibleColumns:E}),overflow:"hidden"},className:`${C}__tr`,children:[I.jsx("div",{role:"columnheader",className:`${C}__select-all-cell-container`,style:{width:s==null?void 0:s.rowHeaderWidth,height:s==null?void 0:s.rowHeight},children:I.jsx("button",{id:`${C}__cell--header--header`,"data-row-index":"header","data-column-index":"header",type:"button",style:{width:s==null?void 0:s.rowHeaderWidth},tabIndex:-1,"aria-label":w,onClick:W,className:we(`${C}__th`,`${C}--interactive-cell-element`,`${C}__th--select-all`,{[`${C}__th--active-header`]:(t==null?void 0:t.column)==="header"&&(t==null?void 0:t.row)==="header"}),children:" "})}),O.headers.map((P,X)=>{const F=ze(P.getHeaderProps(),"key"),$=qt(X,u,"column",m);return I.jsx("div",{role:"columnheader",className:`${C}__columnheader`,...F,children:I.jsx("button",{id:`${C}__cell--header--${X}`,"data-row-index":"header","data-column-index":X,tabIndex:-1,onMouseDown:$?Y(X):void 0,onMouseUp:$&&typeof f=="function"?()=>f(!1):void 0,onClick:$?void 0:D(X),style:{height:s==null?void 0:s.rowHeight,width:(P==null?void 0:P.width)||(s==null?void 0:s.width)},className:we(`${C}__th`,`${C}--interactive-cell-element`,{[`${C}__th--active-header`]:(t==null?void 0:t.column)===X||Ge(X,u,"column"),[`${C}__th--selected-header`]:$,[`${C}__th--selected-header-reorder-active`]:i}),type:"button",children:P.render("Header")})},`column_${X}`)})]},`header_${q}`)})})});Qe.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.number,o.string]),column:o.oneOfType([o.number,o.string])}),cellSize:o.oneOf(["xs","sm","md","lg"]),columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),headerCellHoldActive:o.bool,headerGroups:o.arrayOf(o.object),rows:o.arrayOf(o.object),scrollBarSize:o.number,selectAllAriaLabel:o.string.isRequired,selectedHeaderReorderActive:o.bool,selectionAreas:o.arrayOf(o.object),setActiveCellCoordinates:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalVisibleColumns:o.number,updateActiveCellCoordinates:o.func,visibleColumns:o.array};Qe.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetHeader",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"number"},{name:"string"}],required:!1},column:{name:"union",value:[{name:"number"},{name:"string"}],required:!1}}}},cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"uuid that corresponds to the current selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},headerCellHoldActive:{required:!1,tsType:{name:"boolean"},description:"Whether or not a click/hold is active on a header cell",type:{name:"bool"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"object"}],raw:"object[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"ItemType"}],raw:"ItemType[]"},description:"All of the cell selection area items",type:{name:"arrayOf",value:{name:"object"}}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates value",type:{name:"func"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas value",type:{name:"func"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},updateActiveCellCoordinates:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg) => void",signature:{arguments:[{name:"arg"}],return:{name:"void"}}},description:"Function used to update the active cell coordinates",type:{name:"func"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Array of visible columns provided by react-table useTable hook",type:{name:"array"}}}};const An=()=>{const t=document.createElement("div");t.setAttribute("style","width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;"),document.body.appendChild(t);const e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),e},_n=({placementElement:t,coords:e,addToHeader:a=!1,contextRef:r,blockClass:s=`${pe.prefix}--data-spreadsheet`,onActiveCellChange:p,activeCellValue:c,activeCellRef:u,cellEditorRef:i,defaultColumn:f})=>{if(!e)return;const A=document.querySelector(`[data-row-index="${e.row}"][data-column-index="${e.column}"]`)||document.querySelector(`.${s}__body--td`),b=A.offsetWidth,y=A.offsetHeight,l=a?r==null?void 0:r.current.querySelector(`.${s}__header--container`):r==null?void 0:r.current.querySelector(`.${s}__list--container`).firstElementChild,m={top:t?t.getBoundingClientRect().top-l.getBoundingClientRect().top:e.row===0?0:y*e.row,left:t?t.getBoundingClientRect().left-l.getBoundingClientRect().left:e.column===0?0+(f.rowHeaderWidth-4):b*e.column+(f.rowHeaderWidth-4)},g=u==null?void 0:u.current;g.style.width=ee(t?t==null?void 0:t.offsetWidth:b),g.style.height=ee(t?t==null?void 0:t.offsetHeight:y),g.style.left=ee(m.left),g.style.top=ee(m.top),g.style.display="block",g.setAttribute("data-active-row-index",typeof(e==null?void 0:e.row)=="number"?e.row:"header"),g.setAttribute("data-active-column-index",typeof(e==null?void 0:e.column)=="number"?e.column:"header"),l.appendChild(g),g.focus(),a||l.appendChild(i.current),typeof(e==null?void 0:e.column)=="number"&&typeof(e==null?void 0:e.row)=="number"&&(p==null||p(c))},je=t=>Number(t.replace("rem","")*Ft),In=t=>{switch(t){case"xs":return je(Gt);case"sm":return je(ot);case"md":return je(Xt);case"lg":return je(Rt);default:return je(ot)}},Tn=({activeCellCoordinates:t,cellEditorRulerRef:e,columns:a,previousState:r,removeCellEditor:s,rows:p,setActiveCellCoordinates:c,setCurrentMatcher:u,setSelectionAreas:i,spreadsheetRef:f,updateData:A})=>b=>{const{key:y}=b,l=({type:m})=>{const g=()=>{const j=r==null?void 0:r.activeCellCoordinates,w=p[j==null?void 0:j.row].cells[j==null?void 0:j.column];s(),A(j==null?void 0:j.row,w.column.id)};ge({spreadsheetRef:f}),g();const H=Oe(),N={row:m==="Enter"?t.row===p.length-1?t.row:t.row+1:t.row,column:m==="Tab"?t.column===a.length-1?t.column:t.column+1:t.column};i([{point1:N,point2:N,matcher:H,areaCreated:!1}]),u(H),e.current.textContent=""};y==="Enter"&&(l({type:"Enter"}),c(m=>({...m,row:m.row===p.length-1?m.row:m.row+1}))),y==="Tab"&&(b.preventDefault(),l({type:"Tab"}),c(m=>({...m,column:m.column===a.length-1?m.column:m.column+1})))},oe=`${pe.prefix}--data-spreadsheet`,Ye="DataSpreadsheet",Te={columns:Object.freeze([]),data:Object.freeze([]),defaultEmptyRowCount:16,onDataUpdate:Object.freeze(()=>{}),onActiveCellChange:Object.freeze(()=>{}),onSelectionAreaChange:Object.freeze(()=>{}),theme:"light"};let ye=Jt.forwardRef(({cellSize:t="sm",className:e,columns:a=Te.columns,data:r=Te.data,defaultEmptyRowCount:s=Te.defaultEmptyRowCount,onDataUpdate:p=Te.onDataUpdate,id:c,onActiveCellChange:u=Te.onActiveCellChange,onSelectionAreaChange:i=Te.onSelectionAreaChange,renderRowHeader:f,renderRowHeaderDirection:A,selectAllAriaLabel:b,spreadsheetAriaLabel:y,theme:l,totalVisibleColumns:m,...g},H)=>{const N=h.useRef(null),j=h.useRef(),w=H||j,E=sn(),[_,L]=h.useState(!1),[n,M]=h.useState(null),[D,W]=h.useState([]),[Y,O]=h.useState([]),[q,U]=h.useState(!1),[P,X]=h.useState(""),[F,$]=h.useState(!1),[ae,ue]=h.useState(""),[se,V]=h.useState(!1),[v,te]=h.useState(!1),Z=h.useRef(!1),[le,be]=h.useState(!1),[he,fe]=h.useState(!1),G=Ue({activeCellCoordinates:n,isEditing:F,cellEditorValue:ae})||{},ce=In(t),d=h.useRef(),[B,k]=h.useState(),z=h.useRef(),T=h.useRef(),J=typeof f=="function",me=r.length.toString().length,de=h.useMemo(()=>({width:150,rowHeaderWidth:J?40+me*8.56:64,rowHeight:ce}),[ce,J,me]),{keysPressedList:Fe,usingMac:Pe}=rn({ref:N,containerHasFocus:_,isEditing:F}),Ze=h.useMemo(()=>An(),[]),{getTableProps:jt,getTableBodyProps:Ot,headerGroups:ve,rows:ne,totalColumnsWidth:kt,prepareRow:Lt,setColumnOrder:Pt,visibleColumns:Re}=Xe.useTable({columns:a,data:r,defaultColumn:de},Xe.useBlockLayout,Xe.useColumnOrder),Me=h.useCallback((S,x,K)=>{p(Q=>Q.map((re,xe)=>xe===S?{...Q[S],[x]:ae||K}:re))},[ae,p]),Ne=h.useCallback(()=>{var x;const S=(x=w==null?void 0:w.current)==null?void 0:x.querySelector(`.${oe}__active-cell--highlight`);S&&(S.style.display="none")},[w]),Ae=h.useCallback(()=>{ue(""),$(!1),d!=null&&d.current&&(d.current.style.display="none")},[]);h.useEffect(()=>{const S=G==null?void 0:G.activeCellCoordinates;if(((S==null?void 0:S.row)!==(n==null?void 0:n.row)||(S==null?void 0:S.column)!==(n==null?void 0:n.column))&&F){const x=ne[Number(S==null?void 0:S.row)].cells[Number(S==null?void 0:S.column)];Ae(),Me(S==null?void 0:S.row,x.column.id,void 0),T!=null&&T.current&&(T.current.textContent="")}if((S==null?void 0:S.row)!==(n==null?void 0:n.row)||(S==null?void 0:S.column)!==(n==null?void 0:n.column)){if(n&&(n==null?void 0:n.row)!=="header"&&(n==null?void 0:n.column)!=="header"){const x=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?ne[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;k(x?x.render("Cell"):null)}(n&&(n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&(k(null),be(x=>!x))}F&&G.activeCellCoordinates&&Z.current&&(k(G.cellEditorValue),Z.current=!1,Ae())},[Z,n,G==null?void 0:G.activeCellCoordinates,G==null?void 0:G.cellEditorValue,Me,ne,F,Ae,B]);const Nt=h.useCallback(({placementElement:S,coords:x,addToHeader:K=!1})=>{const Q=typeof(x==null?void 0:x.column)=="number"&&typeof(x==null?void 0:x.row)=="number"?ne[x==null?void 0:x.row].cells[x==null?void 0:x.column]:null,re=Q?Object.values(Q.row.values)[x==null?void 0:x.column]:null;_n({placementElement:S,coords:x,addToHeader:K,contextRef:w,blockClass:oe,onActiveCellChange:u,activeCellValue:re,activeCellRef:z,cellEditorRef:d,defaultColumn:de})},[w,ne,u,de]);cn({focusedElement:E,removeActiveCell:Ne,setContainerHasFocus:L}),un({isBlurSpreadsheet:Z,spreadsheetRef:w,setActiveCellCoordinates:M,setSelectionAreas:W,removeActiveCell:Ne,setContainerHasFocus:L,removeCellEditor:Ae}),on({spreadsheetRef:w,activeCellCoordinates:n,containerHasFocus:_,createActiveCell:Nt,activeCellContent:B,isActiveHeaderCellChanged:le});const Ce=h.useCallback(()=>{fe(!1),n||M({column:"header",row:"header"})},[n]),Se=h.useCallback(({coords:S={...n},updatedValue:x,optOutOfSelectionAreaUpdate:K=!1})=>{const Q={...S,...x};if(M(Q),Q.row!=="header"&&Q.column!=="header"&&!K){const re=Oe();W([{point1:Q,matcher:re}]),X(re)}},[n]),et=h.useCallback(({type:S})=>{const x={...n};Se({coords:x,updatedValue:{column:S==="Home"?0:a.length-1}}),ge({matcher:void 0,spreadsheetRef:w})},[n,Se,w,a.length]),tt=h.useCallback(S=>F||S==="Meta"||S==="Control",[F]),nt=h.useCallback(S=>{event==null||event.preventDefault(),Ce();const x={...n};let K;switch(S){case"ArrowLeft":{if(x.column==="header")return;typeof x.column=="number"&&(x.column===0?K={column:"header"}:K={column:x.column-1});break}case"ArrowUp":{if(x.row==="header")return;typeof x.row=="number"&&(x.row===0?K={row:"header"}:K={row:x.row-1});break}case"ArrowRight":{if(x.column==="header"&&(K={column:0}),typeof x.column=="number"){if(a.length-1===x.column)return;K={column:x.column+1}}break}case"ArrowDown":{if(x.row==="header"&&(K={row:0}),typeof x.row=="number"){if(ne.length-1===x.row)return;K={row:x.row+1}}break}}K&&Se({coords:x,updatedValue:K})},[Ce,Se,n,a,ne]),Wt=h.useCallback(S=>{Sn(S,he,Se,n,Ne,a,ne,w,P,Ae,D,et,Fe,Pe,Me,tt,nt,W,O,X,z,M,L,k)},[he,Se,n,Ne,a,ne,w,P,Ae,D,et,Fe,Pe,Me,tt,nt]),rt=()=>{var K,Q,re,xe;$(!0),U(!1);const S=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?ne[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;let x;S&&(n!=null&&n.column)&&(x=S?(Q=(K=S.row.cells)==null?void 0:K[n==null?void 0:n.column])==null?void 0:Q.value:null),ue(x||""),T!=null&&T.current&&(T.current.textContent=x),d!=null&&d.current&&(z!=null&&z.current)&&(d.current.style.width=(xe=(re=z==null?void 0:z.current)==null?void 0:re.style)==null?void 0:xe.width)};h.useEffect(()=>{var S,x,K,Q,re,xe;F&&!(G!=null&&G.isEditing)&&((re=d==null?void 0:d.current)==null||re.setSelectionRange(Number((x=(S=T==null?void 0:T.current)==null?void 0:S.textContent)==null?void 0:x.length),Number((Q=(K=T==null?void 0:T.current)==null?void 0:K.textContent)==null?void 0:Q.length)),(xe=d==null?void 0:d.current)==null||xe.focus())},[F,G==null?void 0:G.isEditing]);const Vt=()=>{if((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header"){const S=(n==null?void 0:n.row)==="header"?n==null?void 0:n.column:n==null?void 0:n.row;if((n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)==="header")return;at({isKeyboard:!1,index:Number(S)})}},Bt=()=>{U(!1)},zt=()=>{if((n==null?void 0:n.row)!=="header"||(n==null?void 0:n.column)!=="header"){const S=Oe();U(!0),ge({matcher:null,spreadsheetRef:w}),W([{point1:n,matcher:S}]),X(S),O([]),fe(!1)}},Et=S=>{const{key:x}=S;x==="Enter"&&!he&&((n==null?void 0:n.column)!=="header"&&(n==null?void 0:n.row)!=="header"&&rt(),((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&at({isKeyboard:!0}))},at=({isKeyboard:S,index:x=-1})=>{const K={activeCellCoordinates:n,rows:ne,columns:a,currentMatcher:P,setActiveCellCoordinates:M,setCurrentMatcher:X,setSelectionAreas:W,spreadsheetRef:w,index:x,isKeyboard:S,setSelectionAreaData:O,isHoldingCommandKey:null,isHoldingShiftKey:null};(n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)!=="header"&&Ee({type:"column",...K}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)!=="header"&&Ee({type:"row",...K}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)==="header"&&Dt({ref:w,setCurrentMatcher:X,setSelectionAreas:W,rows:ne,columns:a,activeCellCoordinates:n,updateActiveCellCoordinates:Se})},Ut=()=>{rt()};ln({isEditing:F,rows:ne,activeCellCoordinates:n,activeCellRef:z,cellEditorRef:d,cellEditorRulerRef:T,visibleColumns:Re,defaultColumn:de,cellEditorValue:ae});const st=h.useCallback((S,x)=>{P&&S&&S.length&&x&&P&&W(K=>{const Q=ie(K),re=Q.findIndex(xe=>xe.matcher===P);return re===-1?K:typeof Q[re].point2=="object"&&Q[re].areaCreated?(Q[re].point2=Q[re].point1,Q[re].areaCreated=!1,fe(!1),ge({matcher:P,spreadsheetRef:w}),Q):K})},[w,P]),Kt=h.useCallback(()=>{st(D,q)},[q,D,st]);return I.jsx("div",{...g,...jt(),...an(Ye),className:we(oe,e,`${oe}--interactive-cell-element`,{[`${oe}__container-has-focus`]:_,[`${oe}__${l}`]:l==="dark"}),ref:w,role:"grid",tabIndex:0,"aria-rowcount":(ne==null?void 0:ne.length)||0,"aria-colcount":(a==null?void 0:a.length)||0,"aria-label":y,onKeyDown:Wt,onFocus:()=>L(!0),children:I.jsxs("div",{ref:N,children:[I.jsx(Qe,{ref:w,activeCellCoordinates:n,cellSize:t,columns:a,currentMatcher:P,defaultColumn:de,selectedHeaderReorderActive:v,setSelectedHeaderReorderActive:te,headerGroups:ve,rows:ne,scrollBarSize:Ze,selectionAreas:D,setActiveCellCoordinates:M,setSelectionAreas:W,setCurrentMatcher:X,setSelectionAreaData:O,totalVisibleColumns:m,updateActiveCellCoordinates:Se,setHeaderCellHoldActive:V,headerCellHoldActive:se,visibleColumns:Re,selectAllAriaLabel:b}),I.jsx(Je,{activeCellRef:z,activeCellCoordinates:n,ref:w,clickAndHoldActive:q,setClickAndHoldActive:U,currentMatcher:P,setCurrentMatcher:X,setContainerHasFocus:L,selectedHeaderReorderActive:v,setSelectedHeaderReorderActive:te,selectionAreas:D,setSelectionAreas:W,headerGroups:ve,defaultColumn:de,getTableBodyProps:Ot,hasCustomRowHeader:J,onDataUpdate:p,renderRowHeaderDirection:A,renderRowHeader:f,onActiveCellChange:u,onSelectionAreaChange:i,prepareRow:Lt,rows:ne,selectionAreaData:Y,setSelectionAreaData:O,setActiveCellCoordinates:M,scrollBarSize:Ze,totalColumnsWidth:kt,id:c,columns:a,defaultEmptyRowCount:s,setActiveCellInsideSelectionArea:fe,totalVisibleColumns:m,setHeaderCellHoldActive:V,setColumnOrder:Pt,visibleColumns:Re}),I.jsx("button",{onMouseDown:zt,onMouseUp:Bt,onClick:Vt,onKeyDown:Et,onDoubleClick:Ut,onMouseEnter:Kt,ref:z,className:we(`${oe}--interactive-cell-element`,`${oe}__active-cell--highlight`,{[`${oe}__active-cell--with-selection`]:he}),type:"button",children:B}),I.jsx("textarea",{id:`${oe}__cell-editor-text-area`,value:ae,onKeyDown:Tn({activeCellCoordinates:n,cellEditorRulerRef:T,columns:a,previousState:G,removeCellEditor:Ae,rows:ne,setActiveCellCoordinates:M,setCurrentMatcher:X,setSelectionAreas:W,spreadsheetRef:w,updateData:Me}),onChange:S=>{G.isEditing&&(ue(S.target.value),T!=null&&T.current&&(T.current.textContent=S.target.value))},ref:d,"aria-labelledby":n?`${oe}__cell--${n==null?void 0:n.row}--${n==null?void 0:n.column}`:"",className:we(`${oe}__cell-editor`,`${oe}--interactive-cell-element`,`${oe}__cell-editor--${t}`,{[`${oe}__cell-editor--active`]:F})}),I.jsx("pre",{"aria-hidden":!0,ref:T,className:`${oe}__cell-editor-ruler`})]})})});ye=pe.checkComponentEnabled(ye,Ye);ye.displayName=Ye;ye.propTypes={cellSize:o.oneOf(["xs","sm","md","lg"]),className:o.string,columns:o.arrayOf(o.shape({Header:o.string,accessor:o.oneOfType([o.string,o.func]),Cell:o.func})),data:o.arrayOf(o.shape),defaultEmptyRowCount:o.number,hasCustomRowHeader:o.bool,id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,renderRowHeader:o.func,renderRowHeaderDirection:o.oneOf(["left","right"]),selectAllAriaLabel:o.string.isRequired,spreadsheetAriaLabel:o.string.isRequired,theme:o.oneOf(["light","dark"]),totalVisibleColumns:o.number};ye.__docgenInfo={description:"DataSpreadsheet: used to organize and display large amounts of structured data, separated by columns and rows in a grid-like format.",methods:[],displayName:"DataSpreadsheet",props:{cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",defaultValue:{value:"'sm'",computed:!1},type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},className:{required:!1,tsType:{name:"string"},description:"Provide an optional class to be applied to the containing node.",type:{name:"string"}},columns:{required:!1,tsType:{name:"unknown"},description:"The data that will build the column headers",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:{Header:{name:"string",required:!1},accessor:{name:"union",value:[{name:"string"},{name:"func"}],required:!1},Cell:{name:"func",required:!1}}}}},data:{required:!1,tsType:{name:"unknown"},description:"The spreadsheet data that will be rendered in the body of the spreadsheet component",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:"",computed:!0}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",defaultValue:{value:"16",computed:!1},type:{name:"number"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if has custom row header component attached",type:{name:"bool"}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The setter fn for the data prop",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the selection area values change",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},renderRowHeaderDirection:{required:!1,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:"Position of the custom row numbering component",type:{name:"enum",value:[{value:"'left'",computed:!1},{value:"'right'",computed:!1}]}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},spreadsheetAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Data spreadsheet component",type:{name:"string"}},theme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"The theme the DataSpreadsheet should use (only used to render active cell/selection area colors on dark theme)",type:{name:"enum",value:[{value:"'light'",computed:!1},{value:"'dark'",computed:!1}]}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}}}};const lt=["dog","cat","bird","lizard","frog","hamster","fish","rabbit","snake"],We=["Bruno","Willow","Kona","Heidi","Rusty","Bonnie","Cash","Gucci","Brody","Emma","Loki","Angel","Astro","Sherman","Layla","Peanut","Grace","Mickey","Sasha","Finn","Tucker","Bear","Mocha","Roscoe"],Hn=t=>{const e=[];for(let a=0;a<t;a++)e.push(a);return e},$n=t=>{const e=t&&{ownerName:We[Math.floor(Math.random()*We.length)],weight:Math.floor(Math.random()*40)},a={petType:lt[Math.floor(Math.random()*lt.length)],firstName:We[Math.floor(Math.random()*We.length)],age:Math.floor(Math.random()*30),visits:Math.floor(Math.random()*40),health:Math.floor(Math.random()*100)};return t?{...a,...e}:a},Ke=({rows:t,extraColumns:e})=>((r=0)=>{const p=[t][r];return Hn(p).map(()=>({...$n(e)}))})();function mt(t){const e={a:"a",h1:"h1",h2:"h2",li:"li",ul:"ul",...$t(),...t.components};return I.jsxs(I.Fragment,{children:[I.jsx(e.h1,{id:"dataspreadsheet",children:"DataSpreadsheet"}),`
`,I.jsx(e.h2,{id:"table-of-contents",children:"Table of Contents"}),`
`,I.jsxs(e.ul,{children:[`
`,I.jsx(e.li,{children:I.jsx(e.a,{href:"#overview",children:"Overview"})}),`
`,I.jsx(e.li,{children:I.jsx(e.a,{href:"#example-usage",children:"Example usage"})}),`
`,I.jsx(e.li,{children:I.jsx(e.a,{href:"#component-api",children:"Component API"})}),`
`]}),`
`,I.jsx(e.h2,{id:"overview",children:"Overview"}),`
`,`
`,I.jsx(e.h2,{id:"example-usage",children:"Example usage"}),`
`,`
`,I.jsx(Qt,{children:I.jsx(Yt,{of:_e})}),`
`,I.jsx(e.h2,{id:"code-sample",children:"Code sample"}),`
`,`
`,I.jsx(e.h2,{id:"component-api",children:"Component API"}),`
`,I.jsx(Zt,{})]})}function Dn(t={}){const{wrapper:e}={...$t(),...t.components};return e?I.jsx(e,{...t,children:I.jsx(mt,{...t})}):mt(t)}const qn="div[data-story-title*=DataSpreadsheet] .docs-story>div:first-child>div:first-child{overflow:auto;width:100%}",hr={title:"IBM Products/Components/Data spreadsheet/DataSpreadsheet",component:ye,tags:["autodocs"],argTypes:{onActiveCellChange:{action:"active cell change"},onSelectionAreaChange:{action:"selection area change"}},parameters:{styles:qn,docs:{page:Dn}}},Ve=({value:t})=>I.jsx("span",{style:{display:"flex",justifyContent:"flex-end"},children:t}),Le=[{Header:"Row Index",accessor:(t,e)=>e,Cell:({cell:{value:t}})=>I.jsx(Ve,{value:t}),placement:"right",width:275},{Header:"Pet type",accessor:"petType"},{Header:"First Name",accessor:"firstName"},{Header:"Age",accessor:"age",Cell:({cell:{value:t}})=>I.jsx(Ve,{value:t}),placement:"right"},{Header:"Vet visits",accessor:"visits",Cell:({cell:{value:t}})=>I.jsx(Ve,{value:t}),placement:"right"},{Header:"Health",accessor:"health",Cell:({cell:{value:t}})=>I.jsx(Ve,{value:t}),placement:"right"}],Mn=({...t})=>{const[e,a]=h.useState(()=>Ke({rows:16})),r=h.useMemo(()=>Le,[]);return I.jsx(ye,{columns:r,data:e,onDataUpdate:a,id:"spreadsheet--id",...t})},jn=({...t})=>{const[e,a]=h.useState(()=>Ke({rows:1e5})),r=h.useMemo(()=>Le,[]),s=p=>I.jsx(vt,{style:{width:"32px",height:"32px",minWidth:"32px",minHeight:"32px"},children:I.jsx(Ct,{itemText:`Test item ${p}`})});return I.jsx(ye,{columns:r,data:e,onDataUpdate:a,renderRowHeaderDirection:"Left",renderRowHeader:s,id:"spreadsheet--id",...t})},On=({...t})=>{const[e,a]=h.useState(()=>Ke({rows:1e3})),r=h.useMemo(()=>Le,[]);return I.jsx(ye,{columns:r,data:e,onDataUpdate:a,id:"spreadsheet--id",...t})},kn=({...t})=>{const[e,a]=h.useState([]),r=h.useMemo(()=>[...Le.filter(p=>p.Header!=="Row Index")],[]),s=h.useMemo(()=>r,[r]);return I.jsx(ye,{columns:s,data:e,onDataUpdate:a,id:"spreadsheet--id",...t})},Ln=({...t})=>{const[e,a]=h.useState(()=>Ke({rows:24,extraColumns:!0})),r=h.useMemo(()=>[...Le,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=h.useMemo(()=>r,[r]);return I.jsx(ye,{columns:s,data:e,onDataUpdate:a,id:"spreadsheet--id",...t})},_e=Mn.bind({});_e.storyName="Basic spreadsheet";_e.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const He=On.bind({});He.storyName="Large dataset";He.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const $e=jn.bind({});$e.storyName="Large dataset with optional component";$e.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const De=kn.bind({});De.storyName="Empty with cells";De.args={defaultEmptyRowCount:24,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const qe=Ln.bind({});qe.storyName="With many columns";qe.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};var dt,ht,pt;_e.parameters={..._e.parameters,docs:{...(dt=_e.parameters)==null?void 0:dt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 16
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(pt=(ht=_e.parameters)==null?void 0:ht.docs)==null?void 0:pt.source}}};var ft,wt,yt;He.parameters={...He.parameters,docs:{...(ft=He.parameters)==null?void 0:ft.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 1000
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(yt=(wt=He.parameters)==null?void 0:wt.docs)==null?void 0:yt.source}}};var gt,bt,xt;$e.parameters={...$e.parameters,docs:{...(gt=$e.parameters)==null?void 0:gt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 100000
  }));
  const columns = useMemo(() => columnData, []);
  const buildComponent = index => <OverflowMenu style={{
    width: '32px',
    height: '32px',
    minWidth: '32px',
    minHeight: '32px'
  }}>
      <OverflowMenuItem itemText={\`Test item \${index}\`} />
    </OverflowMenu>;
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} renderRowHeaderDirection="Left" renderRowHeader={buildComponent} id="spreadsheet--id" {...args} />;
}`,...(xt=(bt=$e.parameters)==null?void 0:bt.docs)==null?void 0:xt.source}}};var St,At,_t;De.parameters={...De.parameters,docs:{...(St=De.parameters)==null?void 0:St.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState([]);
  const columnDataClone = useMemo(() => [...columnData.filter(item => item.Header !== 'Row Index')], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(_t=(At=De.parameters)==null?void 0:At.docs)==null?void 0:_t.source}}};var It,Tt,Ht;qe.parameters={...qe.parameters,docs:{...(It=qe.parameters)==null?void 0:It.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Ht=(Tt=qe.parameters)==null?void 0:Tt.docs)==null?void 0:Ht.source}}};const pr=["dataSpreadsheet","largeDatasetSpreadsheet","largeDatasetSpreadsheetCustom","emptyWithCells","withManyColumns"];export{pr as __namedExportsOrder,_e as dataSpreadsheet,hr as default,De as emptyWithCells,He as largeDatasetSpreadsheet,$e as largeDatasetSpreadsheetCustom,qe as withManyColumns};
