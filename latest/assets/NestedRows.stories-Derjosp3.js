import{p as oe,j as m,c as B}from"./settings-DDDiKwEV.js";import{r as g,R as E}from"./index-BwDkhjyp.js";import{a as L}from"./chunk-MZXVCX43-CM0pFb8Z.js";import{c as U,D,a as ie,m as N,u as _}from"./_storybook-styles-h9--y7BH.js";import{D as j}from"./DatagridActions-DyMyt3M6.js";import{A as R}from"./getArgTypes-CUsKgYxs.js";import{S as ne}from"./StoryDocsPage-CfmQO964.js";import{c as k}from"./floating-ui.react-BgNs4SA8.js";import{u as de}from"./useFocusRowExpander-9BajiKyr.js";import{h as pe}from"./events-Dp3Lalez.js";import{u as ce}from"./useSelectRows-CXe7onvQ.js";import{a as me}from"./bucket-6-CS7rNrxx.js";import{T as le}from"./bucket-16-DFCeQRVG.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-CJvxHwuA.js";import"./index-Dk74W0Oi.js";import"./index-BLdp044m.js";import"./v4-CQkTLCs1.js";import"./devtools-C7Iu0rt6.js";import"./feature-flags-CaJ_YE9P.js";import"./index-DshjxXYm.js";import"./TableRow-CUMskZDA.js";import"./wrapComponent-EQHqN-fS.js";import"./bucket-0-Cw-xsoio.js";import"./TableToolbar-DziYVX_8.js";import"./Text-DpcC0Z3Y.js";import"./ErrorEmptyState-DuJZAuOh.js";import"./Link-DHwEx_0L.js";import"./EmptyState-CjHe8Iv0.js";import"./props-helper-D2PZmIqz.js";import"./EmptyStateV2-CHRoigZZ.js";import"./iframe-D1NHqrr9.js";import"../sb-preview/runtime.js";import"./ErrorIllustration-BhpMbBlL.js";import"./uuidv4-BQrI85uz.js";import"./index-BONylQH5.js";import"./NoDataEmptyState-C6BC1rJ0.js";import"./NoDataIllustration-DPQ5KKyn.js";import"./NotFoundEmptyState-BbZN2vrh.js";import"./NotFoundIllustration-jlgxfDSo.js";import"./index.esm-qM8NAUcO.js";import"./usePreviousValue-DDnp_zt4.js";import"./extends-CCbyfPlC.js";import"./index-Cfxh4ZWR.js";import"./index-C2eUe6cH.js";import"./index-C0xX6qoh.js";import"./index-DrFu-skq.js";import"./useResizeObserver-CYrpFlRY.js";import"./useWindowResize-DdSPNfdm.js";import"./useControllableState-DwpxGhsf.js";import"./useAttachedMenu-Ba8a--1h.js";import"./mergeRefs-CTUecegF.js";import"./getFocusableElements-BW7cf991.js";import"./index-DW1YkzHB.js";import"./useClickOutside-Dcd11u7q.js";import"./AccordionItem-PQBPj2OV.js";import"./Search-DEO4IeZ8.js";import"./FormContext-C7kRVu4t.js";import"./bucket-14-BmSAzvkd.js";import"./index-Bd0eoXr0.js";import"./LayerContext-DbU-6VX4.js";import"./motionConstants-CR5hPmRc.js";import"./tslib.es6-B4_xh3D5.js";import"./use-reduced-motion-BisnjenD.js";import"./index-DkUr2NOz.js";import"./ActionSet-7kyZHLkU.js";import"./ButtonSet-Dwf_xrN7.js";import"./InlineLoading-BvhLs1sa.js";import"./Checkbox-Eq23awQn.js";import"./bucket-18-D_XNNF5i.js";import"./DatePicker-Dr8agIg8.js";import"./bucket-1-DMFHDXY9.js";import"./Dropdown-kl0VN08K.js";import"./index-C7XzgV7l.js";import"./index-DcAOwtUU.js";import"./FormGroup-DoLxBdhK.js";import"./NumberInput-NTFTuQL2.js";import"./useNormalizedInputProps-DtF50Ia0.js";import"./bucket-15-DqJqYgDY.js";import"./RadioButton-Dk88TpeT.js";import"./RadioButtonGroup-CQZQsCyP.js";import"./MultiSelect-CexdsJ1A.js";import"./index-CfyPTyT-.js";import"./debounce-CI22LTdx.js";import"./toNumber-DVQITUtX.js";import"./TagSet-CHGYYjbB.js";import"./Tag-CpKCZnUV.js";import"./DefinitionTooltip-MY7U3cvT.js";import"./ComposedModal-BB3t0zem.js";import"./requiredIfGivenPropIsTruthy-CU7JwK8h.js";import"./wrapFocus-CuszVIVc.js";import"./index-BK1SMh4y.js";import"./usePortalTarget-BD2WdNlr.js";import"./SkeletonText-CniiJqu_.js";import"./getNodeTextContent-C8IeKkUQ.js";import"./index-C9z6BHTc.js";import"./bucket-17-B2E3mTyd.js";import"./index-D9ju4W2A.js";import"./bucket-12-C33cLYA1.js";import"./TableToolbarSearch-D107niuO.js";import"./bucket-5-BlAGcMmC.js";import"./bucket-13-DEUQBRGC.js";import"./story-helper-BB2of0Wm.js";import"./TableSelectRow-BKjySdBz.js";const f=`${oe.prefix}--datagrid`,ue=e=>{const i=g.useRef(),a=g.useRef(),n=c=>{i.current=c};de({instance:i==null?void 0:i.current,lastExpandedRowIndex:a==null?void 0:a.current,blockClass:f,activeElement:typeof document<"u"&&document.activeElement});const p=(c,u)=>{const{getAsyncSubRows:l,dispatch:o,state:s}=u.instance||{},t=!!s.dynamicRowSkeleton;return[{id:"expander",Cell:({row:r})=>{const P={...r.getToggleRowExpandedProps(),disabled:l&&t,onClick:async z=>{if(z.stopPropagation(),r.toggleRowExpanded(),a.current=r.id,!r.isExpanded)try{U({dispatch:o,status:"start",rowId:r.id,depth:r.depth,index:r.index}),await(l==null?void 0:l(r)),U({dispatch:o,status:"finish",rowId:r.id})}catch(ae){console.log({error:ae})}}},{expanderButtonTitleExpanded:v="Collapse row",expanderButtonTitleCollapsed:H="Expand row"}=(i==null?void 0:i.current)||{},I=r.isExpanded?v:H;return(r.canExpand||l)&&m.jsx("button",{type:"button","aria-label":I,className:k(`${f}__row-expander`,`${B.prefix}--btn`,`${B.prefix}--btn--ghost`),...P,children:m.jsx(pe,{className:k(`${f}__expander-icon`,{[`${f}__expander-icon--not-open`]:!r.isExpanded,[`${f}__expander-icon--open`]:r.isExpanded})})})},width:48,disableResizing:!0,disableSortBy:!0,Header:""},...c]};e.visibleColumns.push(p),e.useInstance.push(n)},W=`${oe.prefix}--datagrid`,G=e=>{ue(e);const i=a=>{g.useEffect(()=>{const{rows:o}=a,s=o.filter(t=>{var d;return(d=t==null?void 0:t.original)==null?void 0:d.defaultExpanded});s!=null&&s.length&&s.map(t=>{var d;if(!(t!=null&&t.isExpanded)&&!(t!=null&&t.hasExpanded)){(d=t==null?void 0:t.toggleRowExpanded)==null||d.call(t),t.hasExpanded=!0;return}})},[a,a.rows]),g.useEffect(()=>{const{rows:o,initialState:s}=a,{expandedRowIds:t}=s;t&&Object.keys(t).forEach(d=>{var P,v;const r=o.filter(H=>{var I,z;return H.id.toString()===d.toString()||((z=(I=H.original)==null?void 0:I.id)==null?void 0:z.toString())===d.toString()});(r.length&&d.toString()===r[0].id.toString()||r.length&&d.toString()===((v=(P=r[0].original)==null?void 0:P.id)==null?void 0:v.toString()))&&r[0].toggleRowExpanded()})},[a]);const n=24,p=(o,{row:s})=>[o,{className:k({[`${W}__carbon-nested-row`]:s.depth>0,[`${W}__carbon-row-expanded`]:s.isExpanded})}],c=(o,{row:s})=>[o,{style:{paddingLeft:`${s.depth>1?n*2+(s.depth-1)*(n+n/3):s.depth===1?n*2:0}px`}}],u=o=>32*o+16,l=(o,{cell:s,instance:t})=>{const d=t.columns.findIndex(r=>r.id===s.column.id)===0;return[o,{style:{marginRight:d&&s.row.depth>0&&parseInt(o.style.width,10)<=u(s.row.depth)+50?`${parseInt(o.style.width,10)-(u(s.row.depth)+50)}px`:"",width:d&&s.row.depth>0?parseInt(o.style.width,10)-u(s.row.depth):o.style.width}}]};Object.assign(a,{withNestedRows:!0}),e.getRowProps.push(p),e.getRowProps.push(c),e.getCellProps.push(l)};e.useInstance.push(i)},T={gridTitle:R.gridTitle,gridDescription:R.gridDescription,useDenseHeader:R.useDenseHeader,rowSize:R.rowSize,rowSizes:R.rowSizes,onRowSizeChange:R.onRowSizeChange,expanderButtonTitleExpanded:"Collapse row",expanderButtonTitleCollapsed:"Expand row"},fs={title:"IBM Products/Components/Datagrid/NestedRows",component:D,tags:["autodocs"],parameters:{styles:ie,docs:{page:()=>m.jsx(ne,{omitCodedExample:!0,blocks:[{title:"Nested rows",description:"Nested rows allow disclosing content in data tables progressively by displaying primary data first (parent row) and enabling users to navigate secondary information levels (child rows).\n- Include the `useNestedRows` hook\n- Make sure that any row you want to have nested rows in your data has a `subRows` property with an array of objects for each nested row. The row expander will be included by default as long as the `useNestedRows` hook is provided and it is detected that a row has `subRows` within it.\n          ",source:{code:`
const datagridState = useDatagrid(
  {
    columns,
    data,
    expanderButtonTitleExpanded: 'Collapse row',
    expanderButtonTitleCollapsed: 'Expand row',
  },
  useNestedRows
);

return <Datagrid datagridState={datagridState} />;
            `}}]})},layout:"padded"},argTypes:{featureFlags:{table:{disable:!0}}}},$=[{Header:"Row Index",accessor:(e,i)=>i,sticky:"left",id:"rowIndex"},{Header:"First Name",accessor:"firstName"},{Header:"Last Name",accessor:"lastName"},{Header:"Age",accessor:"age",width:50},{Header:"Visits",accessor:"visits",width:60},{Header:"Someone 1",accessor:"someone1"},{Header:"Someone 2",accessor:"someone2"},{Header:"Someone 3",accessor:"someone3"},{Header:"Someone 4",accessor:"someone4"},{Header:"Someone 5",accessor:"someone5"},{Header:"Someone 6",accessor:"someone6"},{Header:"Someone 7",accessor:"someone7"},{Header:"Someone 8",accessor:"someone8"},{Header:"Someone 9",accessor:"someone9"},{Header:"Someone 10",accessor:"someone10"}],b={emptyStateTitle:"Empty state title",emptyStateDescription:"Description text explaining why table is empty",emptyStateSize:"lg",gridTitle:"Data table title",gridDescription:"Additional information if needed",useDenseHeader:!1,rowSize:"lg",rowSizes:[{value:"xl",labelText:"Extra large"},{value:"lg",labelText:"Large"},{value:"md",labelText:"Medium"},{value:"xs",labelText:"Small"}],onRowSizeChange:e=>{console.log("row size changed to: ",e)},rowActions:[{id:"edit",itemText:"Edit",icon:me,onClick:L("Clicked row action: edit")},{id:"delete",itemText:"Delete",icon:le,isDelete:!0,onClick:L("Clicked row action: delete")}]},C={gridTitle:b.gridTitle,gridDescription:b.gridDescription,useDenseHeader:b.useDenseHeader,rowSize:b.rowSize,rowSizes:b.rowSizes,onRowSizeChange:b.onRowSizeChange},ge=({...e})=>{const i=E.useMemo(()=>$,[]),[a]=g.useState(N(10,2)),n=_({columns:i,data:a,DatagridActions:j,autoResetExpanded:!1,autoResetGlobalFilter:!1,...e.defaultGridProps,getSubRows:p=>p.subRows},G);return m.jsx(D,{datagridState:n})},we=({...e})=>m.jsx(ge,{defaultGridProps:{...e}}),Se="With single-level nested rows",w=we.bind({});w.storyName=Se;w.argTypes={...T};w.args={...C,featureFlags:["Datagrid.useNestedRows"]};const ye=({...e})=>{const i=E.useMemo(()=>$,[]),[a]=g.useState(N(10,5,2,2,{id:"testing-user-provided-id"})),n=_({columns:i,data:a,DatagridActions:j,...e.defaultGridProps,getSubRows:p=>p.subRows},G);return m.jsx(D,{datagridState:{...n}})},re=({...e})=>m.jsx(ye,{defaultGridProps:{...e}}),he="With nested rows",S=re.bind({});S.storyName=he;S.argTypes={...T};S.args={...C};const xe=({...e})=>{const i=E.useMemo(()=>$,[]),[a]=g.useState(N(10,5,2,2)),n=_({columns:i,data:a,DatagridActions:j,...e.defaultGridProps,getSubRows:p=>p.subRows},G,ce);return m.jsx(D,{datagridState:{...n}})},Re=({...e})=>m.jsx(xe,{defaultGridProps:{...e}}),be="With selectable nested rows",y=Re.bind({});y.storyName=be;y.argTypes={...T};y.args={...C};const fe="With initially expanded nested rows",h=re.bind({});h.storyName=fe;h.argTypes={...T};h.args={...C,initialState:{expandedRowIds:{"testing-user-provided-id__1":!0,3:!0}}};const Ne=({...e})=>{const i=E.useMemo(()=>$,[]),[a,n]=g.useState(N(10)),p=_({columns:i,data:a,DatagridActions:j,autoResetExpanded:!1,autoResetGlobalFilter:!1,...e.defaultGridProps,getAsyncSubRows:async c=>{c.subRows.length||await new Promise(u=>{setTimeout(()=>{if(c.depth>0)return u();const l=N(2,{id:"test-id"}),o=[...a],s=o.findIndex(t=>t.id===c.original.id);o[s].subRows=l,n(o),u()},1e3)})},getSubRows:c=>c.subRows},G);return m.jsx(D,{datagridState:p})},De=({...e})=>m.jsx(Ne,{defaultGridProps:{...e}}),Te="Dynamic nested rows",x=De.bind({});x.storyName=Te;x.argTypes={...T};x.args={...C};var A,F,M;w.parameters={...w.parameters,docs:{...(A=w.parameters)==null?void 0:A.docs,source:{originalSource:`({
  ...args
}) => {
  return <SingleLevelNestedRows defaultGridProps={{
    ...args
  }} />;
}`,...(M=(F=w.parameters)==null?void 0:F.docs)==null?void 0:M.source}}};var O,V,Y;S.parameters={...S.parameters,docs:{...(O=S.parameters)==null?void 0:O.docs,source:{originalSource:`({
  ...args
}) => {
  return <NestedRows defaultGridProps={{
    ...args
  }} />;
}`,...(Y=(V=S.parameters)==null?void 0:V.docs)==null?void 0:Y.source}}};var q,J,K;y.parameters={...y.parameters,docs:{...(q=y.parameters)==null?void 0:q.docs,source:{originalSource:`({
  ...args
}) => {
  return <SelectableNestedRows defaultGridProps={{
    ...args
  }} />;
}`,...(K=(J=y.parameters)==null?void 0:J.docs)==null?void 0:K.source}}};var Q,X,Z;h.parameters={...h.parameters,docs:{...(Q=h.parameters)==null?void 0:Q.docs,source:{originalSource:`({
  ...args
}) => {
  return <NestedRows defaultGridProps={{
    ...args
  }} />;
}`,...(Z=(X=h.parameters)==null?void 0:X.docs)==null?void 0:Z.source}}};var ee,te,se;x.parameters={...x.parameters,docs:{...(ee=x.parameters)==null?void 0:ee.docs,source:{originalSource:`({
  ...args
}) => {
  return <DynamicNestedRows defaultGridProps={{
    ...args
  }} />;
}`,...(se=(te=x.parameters)==null?void 0:te.docs)==null?void 0:se.source}}};const Ns=["SingleLevelNestedRowsUsageStory","NestedRowsUsageStory","SelectableNestedRowsUsageStory","NestedRowsInitialUsageStory","DynamicNestedRowStory"];export{x as DynamicNestedRowStory,h as NestedRowsInitialUsageStory,S as NestedRowsUsageStory,y as SelectableNestedRowsUsageStory,w as SingleLevelNestedRowsUsageStory,Ns as __namedExportsOrder,fs as default};
