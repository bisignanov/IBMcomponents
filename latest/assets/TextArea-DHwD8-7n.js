import{u as fe,c as g,_ as pe,d as xe,s as he}from"./deprecate-D9ms-jbM.js";import{P as e}from"./index-Dk74W0Oi.js";import{R as r,r as w}from"./index-BwDkhjyp.js";import{F as ge}from"./FormContext-C7kRVu4t.js";import{u as be}from"./useAnnouncer-MW4fVOqQ.js";import{u as we,d as _e}from"./events-Bq7WR1mU.js";import{n as E}from"./settings-BiUEFdm2.js";import{T as _}from"./Text-_TFgs5hl.js";import{W as K,a as M}from"./bucket-17-CArjO86K.js";const $e=he(),j=r.forwardRef((B,G)=>{var q;const{className:H,disabled:u=!1,id:y,labelText:N,hideLabel:J,onChange:I=E,onClick:W=E,onKeyDown:A=E,invalid:n=!1,invalidText:Q="",helperText:$="",light:U,placeholder:X="",enableCounter:b=!1,maxCount:l=void 0,counterMode:c="character",warn:m=!1,warnText:Y="",rows:Z=4,slug:T,...p}=B,t=fe(),{isFluid:s}=w.useContext(ge),{defaultValue:D,value:R}=p,{current:ee}=w.useRef($e()),o=w.useRef(null),te=we([G,o]);function F(){var f,h;const d=(D||R||((f=o.current)==null?void 0:f.value)||"").toString();return c==="character"?d.length:((h=d.match(/\w+/g))==null?void 0:h.length)||0}const[v,x]=w.useState(F());w.useEffect(()=>{x(F())},[R,D,c]),_e(()=>{p.cols&&o.current?(o.current.style.width="",o.current.style.resize="none"):o.current&&(o.current.style.width="100%")},[p.cols]);const O={id:y,onKeyDown:a=>{if(!u&&b&&c==="word"){const d=a.which;l&&v>=l&&d===32&&a.preventDefault()}!u&&A&&A(a)},onPaste:a=>{if(!u&&c==="word"&&b&&typeof l<"u"&&o.current!==null){const d=o.current.value.match(/\w+/g)||[],f=a.clipboardData.getData("Text").match(/\w+/g)||[];if(d.length+f.length>l){a.preventDefault();const i=d.concat(f).slice(0,l);setTimeout(()=>{x(l)},0),o.current.value=i.join(" ")}}},onChange:a=>{var d,f,h;if(!u){if(c=="character")(d=a==null?void 0:a.persist)==null||d.call(a),setTimeout(()=>{var i,z;x((z=(i=a.target)==null?void 0:i.value)==null?void 0:z.length)},0);else if(c=="word"){if(!a.target.value){setTimeout(()=>{x(0)},0);return}if(b&&typeof l<"u"&&o.current!==null){const i=(h=(f=a.target)==null?void 0:f.value)==null?void 0:h.match(/\w+/g);i&&i.length<=l?(o.current.removeAttribute("maxLength"),setTimeout(()=>{x(i.length)},0)):i&&i.length>l&&setTimeout(()=>{x(i.length)},0)}}I&&I(a)}},onClick:a=>{!u&&W&&W(a)}},ae=g(`${t}--form-item`,H),re=g(`${t}--text-area__wrapper`,{[`${t}--text-area__wrapper--readonly`]:p.readOnly,[`${t}--text-area__wrapper--warn`]:m,[`${t}--text-area__wrapper--slug`]:T}),ne=g(`${t}--label`,{[`${t}--visually-hidden`]:J&&!s,[`${t}--label--disabled`]:u}),le=g(`${t}--text-area`,{[`${t}--text-area--light`]:U,[`${t}--text-area--invalid`]:n,[`${t}--text-area--warn`]:m}),se=g(`${t}--label`,{[`${t}--label--disabled`]:u}),oe=g(`${t}--form__helper-text`,{[`${t}--form__helper-text--disabled`]:u}),ie=N?r.createElement(_,{as:"label",htmlFor:y,className:ne},N):null,ce=b&&l&&(c==="character"||c==="word")?r.createElement(_,{as:"div",className:se},`${v}/${l}`):null,P=$?`text-area-helper-text-${ee}`:void 0,de=$?r.createElement(_,{as:"div",id:P,className:oe},$):null,V=y+"-error-msg",k=n?r.createElement(_,{as:"div",role:"alert",className:`${t}--form-requirement`,id:V},Q,s&&r.createElement(K,{className:`${t}--text-area__invalid-icon`})):null,L=m?r.createElement(_,{as:"div",role:"alert",className:`${t}--form-requirement`},Y,s&&r.createElement(M,{className:`${t}--text-area__invalid-icon ${t}--text-area__invalid-icon--warning`})):null;let C;n?C=V:!n&&!m&&!s&&$&&(C=P),b&&c=="character"&&(O.maxLength=l);const ue=be(v,l,c==="word"?"words":void 0),me=r.createElement("textarea",pe({},p,O,{placeholder:X,className:le,"aria-invalid":n,"aria-describedby":C,disabled:u,rows:Z,readOnly:p.readOnly,ref:te}));let S;return T&&((q=T.type)==null?void 0:q.displayName)==="Slug"&&(S=r.cloneElement(T,{size:"mini"})),r.createElement("div",{className:ae},r.createElement("div",{className:`${t}--text-area__label-wrapper`},ie,ce),r.createElement("div",{className:re,"data-invalid":n||null},n&&!s&&r.createElement(K,{className:`${t}--text-area__invalid-icon`}),m&&!n&&!s&&r.createElement(M,{className:`${t}--text-area__invalid-icon ${t}--text-area__invalid-icon--warning`}),me,S,r.createElement("span",{className:`${t}--text-area__counter-alert`,role:"alert"},ue),s&&r.createElement("hr",{className:`${t}--text-area__divider`}),s&&n?k:null,s&&m&&!n?L:null),!n&&!m&&!s?de:null,n&&!s?k:null,m&&!n&&!s?L:null)});j.displayName="TextArea";j.propTypes={className:e.string,cols:e.number,counterMode:e.oneOf(["character","word"]),defaultValue:e.oneOfType([e.string,e.number]),disabled:e.bool,enableCounter:e.bool,helperText:e.node,hideLabel:e.bool,id:e.string,invalid:e.bool,invalidText:e.node,labelText:e.node.isRequired,light:xe(e.bool),maxCount:e.number,onChange:e.func,onClick:e.func,onKeyDown:e.func,placeholder:e.string,readOnly:e.bool,rows:e.number,slug:e.node,value:e.oneOfType([e.string,e.number]),warn:e.bool,warnText:e.node};export{j as T};
