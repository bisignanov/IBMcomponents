import{r as d}from"./index-BwDkhjyp.js";import{d as v}from"./debounce-Bo8k2pkZ.js";import{c as y}from"./deprecate-D9ms-jbM.js";import{p as x}from"./settings-DrdbGLhD.js";const f=`${x.prefix}--datagrid`,_=`${f}__right-sticky-column`,g=`${f}__left-sticky-column`,p=`${_}-offset-scroll`,E=e=>{const s=d.useRef(),l=d.useRef(),[a,u]=d.useState(null);d.useEffect(()=>{u(window.innerWidth)},[]),d.useLayoutEffect(()=>{function i(){u(window.innerWidth)}return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),e.getCellProps.push(S.bind(null,"cell",null,a)),e.getHeaderProps.push(S.bind(null,"header",l,a)),e.getTableBodyProps.push(b.bind(null,s)),e.getHeaderGroupProps.push(i=>[i,{style:{...i.style,minWidth:"unset"}}]);const m=i=>{d.useEffect(()=>{const n=s.current,t=l.current;$(n)&&t&&t.classList.add(p);const c=v(L.bind(null,n,t),250);return typeof window<"u"&&window.addEventListener("resize",c),()=>{typeof window<"u"&&window.removeEventListener("resize",c)}},[i.rows,i.isFetching]),d.useEffect(()=>{const n=s.current,t=l.current,c=r=>{h(r.target,t)};return h(n,t),n&&n.addEventListener("scroll",c),()=>{n&&n.removeEventListener("scroll",c)}},[i.rows,i.isFetching])},w=i=>{const n=s.current,t=l.current;d.useEffect(()=>{L(n,t)},[i.rows,t,n])};e.useInstance.push(m),e.useInstance.push(w),e.useInstance.push(i=>{Object.assign(i,{withStickyColumn:!0})}),e.useInstance.push(i=>{const n=i.visibleColumns;let t=n.findIndex(o=>o.id==="spacer"),c=n.findIndex(o=>o.sticky==="right");if(t>=0&&c>=0&&c<t){const o=n[t];n[t]=n[c],n[c]=o}const r=i.headers;if(t=r.findIndex(o=>o.id==="spacer"),c=r.findIndex(o=>o.sticky==="right"),t>=0&&c>=0&&c<t){const o=r[t];r[t]=r[c],r[t].canResize=!1,r[t].disableResizing=!0,delete r[t].getResizerProps,r[c]=o}})},b=(e,s)=>[s,{ref:e}],S=(e,s,l,a,u)=>{var w;const m=u.column||u.cell.column;return m.sticky==="right"?[a,{className:y({[`${_}-${e}`]:!0,[`${f}__resizableColumn`]:!1,[`${f}__sortableColumn`]:!1}),...s&&{ref:s}}]:m.sticky==="left"?[a,{className:y({[`${g}-${e}`]:l>671,[`${g}-${e}--with-extra-select-column`]:((w=u==null?void 0:u.instance)==null?void 0:w.withSelectRows)&&l>671}),...s&&{ref:s}}]:[a]},L=(e,s)=>{s&&($(e)?s.classList.add(p):s.classList.remove(p),h(e,s))},h=(e,s)=>{e&&s&&(e.scrollLeft+e.clientWidth===e.scrollWidth?(s.classList.add(`${f}__sticky-noShadow`),e.classList.add(`${f}__sticky-column-noShadow`)):(s.classList.remove(`${f}__sticky-noShadow`),e.classList.remove(`${f}__sticky-column-noShadow`)))},$=e=>{if(!e)return!1;const{scrollHeight:s,clientHeight:l}=e;return s>l};export{E as u};
