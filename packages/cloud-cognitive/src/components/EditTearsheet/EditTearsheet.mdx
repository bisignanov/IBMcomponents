import { Story, ArgsTable, Canvas } from '@storybook/addon-docs';
import {
  getStoryId,
  CodesandboxLink,
} from '../../global/js/utils/story-helper';
import { EditTearsheet } from '.';
import editTearsheetAnatomy from './storybook_assets/edit-tearsheet-2.png';

# EditTearsheet

## Table of Contents

- [Overview](#overview)
- [Example usage](#example-usage)
- [Component API](#component-api)

## Overview

When to use

- The create flow happened in a tear sheet.
- A subset of the related item will be edited.
- You want to keep the user in context instead of taking the user to a new page.
- The amount of content is too much for a modal or narrow tear sheet.
- The content is too complex for a modal or narrow tear sheet.
- If the space to edit in the original location is too restricted (i.e. in a
  narrow side panel), a tear sheet can provide more area to work.

When not to use

- Do not use when the edit actions are few/simple - consider using a modal
  instead.

Anatomy of EditTearsheet

<img src={editTearsheetAnatomy} />

1. **Header**: The header can include title, description, labels, and tabs. Must
   include “Edit” in the title.

2. **Main content area**: This area includes the editable content.

3. **Navigation buttons**: In most cases, the navigation buttons are limited to
   primary and secondary buttons (“Save” and “Cancel”). If the edit flow
   requires steps (not common), the Next/previous buttons serve as the primary
   and secondary buttons until the last step, where the primary button is “Save”
   (Cancel is the ghost button in this case).

4. **Influencer (optional)**: A left side panel that can be used, for example,
   as a menu, progress indicator, or filter. Alternatively, a right side panel
   can be used for a Summary (of changes).

5. **Background overlay**: An overlay which appears same as in modals

## Example usage

<Canvas>
  <Story id={getStoryId(EditTearsheet.displayName, 'multi-step-tearsheet')} />
</Canvas>

This is used when you have one section per step. This can be created by passing
in the overall `<EditTearsheet />` component and the `<EditTearsheetStep />`
component with form items as children:

```jsx
    <EditTearsheet {...props}>
      <EditTearsheetStep
          title="Required title"
          subtitle="Optional subtitle"
          description="Optional description"
          onNext={() => {'Optional function'}}
          disableSubmit={}
          >
        <TextInput
          id="test-1"
          invalidText="A valid value is required"
          labelText="Topic name"
          placeholder="Enter topic name"
        />
      </EditTearsheetStep>
    </EditTearsheet>
```

## Using custom components

It is possible to use custom components that return `EditTearsheetStep`s in
order to help reduce the amount of logic in the component that contains the main
`EditTearsheet`. _It is required that each child of the `EditTearsheet` either
be a custom step or a `EditTearsheetStep`_. An example of this could look like
the following:

```jsx
const CreateStepCustom = ({ subtitle, ...rest }) => {
  return (
    <EditTearsheetStep
      {...rest}
      subtitle={subtitle}
      title="Step 1"
      onNext={() => console.log('optional validation check')}
      onMount={() => console.log('optional onMount fn')}
      disableSubmit={false}
    >
      step content here
    </EditTearsheetStep>
  );
};

const CreateComponent = () => {
  return (
    <EditTearsheet {...EditTearsheetProps}>
      <CreateStepCustom subtitle="Custom step subtitle" />
      <EditTearsheetStep
        title="Topic name"
        fieldsetLegendText="Topic information"
        disableSubmit={!value}
        subtitle="This is the unique name used to recognize your topic"
        description="It will also be used by your producers and consumers as part of the
        connection information, so make it something easy to recognize."
      >
        Content for second step
      </EditTearsheetStep>
    </EditTearsheet>
  );
};
```

## Using dynamic steps

The use of dynamic steps can be utilized in a scenario when the user makes a
certain selection on one step that effects which steps will follow it, this is
controlled via the `includeStep` prop. See abbreviated example below:

```jsx
import { useState } from 'react';

const EditFlow = () => {
  const [shouldIncludeAdditionalStep, setShouldIncludeAdditionalStep] =
    useState(false);
  return (
    <EditTearsheet {...EditTearsheetProps}>
      <EditTearsheetStep {...step1Props}>
        Step 1 content
        <Checkbox
          labelText={`Include additional step`}
          id="include-additional-step-checkbox"
          onChange={(value) => setShouldIncludeAdditionalStep(value)}
          checked={shouldIncludeAdditionalStep}
        />
      </EditTearsheetStep>
      <EditTearsheetStep
        {...step2Props}
        includeStep={shouldIncludeAdditionalStep}
      >
        Dynamic step content
      </EditTearsheetStep>
      <EditTearsheetStep {...step3Props}>Final step content</EditTearsheetStep>
    </EditTearsheet>
  );
};
```

## Class names

Additionally, to get the preferred styling when including your own children as
sections, you can utilize the below included class names.

| Class name                                            | Element     | Features                                                   |
| ----------------------------------------------------- | ----------- | ---------------------------------------------------------- |
| `#{$pkg-prefix}--create-tearsheet__step--title`       | title       | `productive-heading-04` & `margin-bottom` of `$spacing-05` |
| `#{$pkg-prefix}--create-tearsheet__step--subtitle`    | subtitle    | `productive-heading-01` & `margin-bottom` of `$spacing-03` |
| `#{$pkg-prefix}--create-tearsheet__step--description` | description | `body-long-01` & `margin-bottom` of `$spacing-06`          |
| `#{$pkg-prefix}--create-tearsheet__step--fieldset`    | fieldset    | `margin-bottom` of `$spacing-05` to all children elements  |
| `#{$pkg-prefix}--create-tearsheet__section--divider`  | divider     | Includes a `1px` divider line inside the `main` content    |

## Code sample

<CodesandboxLink exampleDirectory="EditTearsheet" />

## Component API

<ArgsTable />
