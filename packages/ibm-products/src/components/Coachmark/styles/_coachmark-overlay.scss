//
// Copyright IBM Corp. 2023, 2023
//
// This source code is licensed under the Apache-2.0 license found in the
// LICENSE file in the root directory of this source tree.
//

// Standard imports.
@import '../../../global/styles/project-settings';
@import '../../../global/styles/mixins';

// Define all component styles in a mixin which is then exported using
// the Carbon import-once mechanism.
@mixin coachmark-overlay {
  // The block part of our conventional BEM class names (blockClass__E--M).
  $block-class: #{$pkg-prefix}--coachmark-overlay;
  $carousel-class: #{$pkg-prefix}--carousel;

  .#{$block-class} {
    color: $inverse-01;
    background-color: $inverse-02;

    $caret-height: calc(
      $spacing-03 - $spacing-01
    ); // from the "peak" of the pyramid to its "base"
    $caret-center: $caret-height; // use "center" for left-right calculations, and "height" for top-bottom calculations
    $distance-offset: $spacing-06; // see also ./utils/constants.js > distanceOffset

    width: carbon--mini-units(36);
    position: absolute;
    border-radius: $spacing-01;
    z-index: 5901;

    &--fixed {
      bottom: 0;
      position: fixed;
      right: $spacing-05;
      transform: translateY(100%);
      transition: 240ms carbon--motion(exit, productive);
    }
    &--is-visible {
      transform: translateY(0);
    }

    // CARET STYLING
    &__caret {
      // background-color: this property is set in _coachmark-overlay-theme.scss
      position: absolute;
      z-index: 5902;

      // border-bottom-color: this property is set in _coachmark-overlay-theme.scss
      border-bottom-style: solid;
      border-bottom-width: $caret-center;
      border-left: $caret-center solid transparent;
      border-right: $caret-center solid transparent;
      height: 0;
      width: 0;
      border-bottom-color: $inverse-02;
    }

    // OVERLAY AND CARET POSITIONING
    &--top {
      $horizontal-push: calc($distance-offset - $caret-center);
      $translate-y: calc(-1 * (100% + $distance-offset + $caret-height));

      transform: translate(-50%, $translate-y);
      .#{$block-class}__caret {
        left: calc(50% - $caret-center);
        transform: rotate(180deg);
      }

      &-left {
        transform: translate(calc(-1 * $distance-offset), $translate-y);
        .#{$block-class}__caret {
          left: $horizontal-push;
          transform: rotate(180deg);
        }
      }
      &-right {
        transform: translate(
          calc(-1 * (100% - $distance-offset)),
          $translate-y
        );
        .#{$block-class}__caret {
          right: $horizontal-push;
          transform: rotate(180deg);
        }
      }
    }

    &--bottom {
      $horizontal-push: calc($distance-offset - $caret-center);
      $top: calc(-1 * $caret-height);
      $translate-y: calc($distance-offset + $caret-height);

      transform: translate(-50%, $translate-y);
      .#{$block-class}__caret {
        left: calc(50% - $caret-center);
        top: $top;
      }

      &-left {
        transform: translate(calc(-1 * $distance-offset), $translate-y);
        .#{$block-class}__caret {
          left: $horizontal-push;
          top: $top;
        }
      }
      &-right {
        transform: translate(
          calc(-1 * (100% - $distance-offset)),
          $translate-y
        );
        .#{$block-class}__caret {
          right: $horizontal-push;
          top: $top;
        }
      }
    }

    &--left {
      $right: calc(-1 * $caret-center * 1.5);
      $translate-x: calc(-1 * (100% + $distance-offset + $caret-center));
      $vertical-push: calc($distance-offset - ($caret-height * 0.5));

      transform: translate($translate-x, -50%);
      .#{$block-class}__caret {
        right: $right;
        top: calc(50% - ($caret-height * 0.5));
        transform: rotate(90deg);
      }

      &-top {
        transform: translate($translate-x, calc(-1 * $distance-offset));
        .#{$block-class}__caret {
          right: $right;
          top: $vertical-push;
          transform: rotate(90deg);
        }
      }
      &-bottom {
        transform: translate(
          $translate-x,
          calc(-1 * (100% - $distance-offset))
        );
        .#{$block-class}__caret {
          bottom: $vertical-push;
          right: $right;
          transform: rotate(90deg);
        }
      }
    }

    &--right {
      $left: calc(-1 * $caret-center * 1.5);
      $translate-x: calc($distance-offset + $caret-center);
      $vertical-push: calc($distance-offset - ($caret-height * 0.5));

      transform: translate($translate-x, -50%);
      .#{$block-class}__caret {
        left: $left;
        top: calc(50% - ($caret-height * 0.5));
        transform: rotate(-90deg);
      }

      &-top {
        transform: translate($translate-x, calc(-1 * $distance-offset));
        .#{$block-class}__caret {
          left: $left;
          top: $vertical-push;
          transform: rotate(-90deg);
        }
      }
      &-bottom {
        transform: translate(
          $translate-x,
          calc(-1 * (100% - $distance-offset))
        );
        .#{$block-class}__caret {
          bottom: $vertical-push;
          left: $left;
          transform: rotate(-90deg);
        }
      }
    }

    // ANIMATED MEDIA
    &__element-stepped-media {
      height: calc($spacing-07 + $spacing-12); // 32 + 96 = 128
      margin-bottom: $spacing-05;
    }

    // BODY
    &__body {
      padding: $spacing-01 $spacing-05 $spacing-05;

      .bx--btn--ghost {
        color: $inverse-link;
        &:hover {
          color: $inverse-link;
        }
      }

      // CAROUSEL ELEMENTS
      #{$block-class}-element {
        display: block;
        max-width: 100%;
        flex: 0 0 100%;

        #{$block-class}-element__content {
          padding-bottom: $spacing-05;
        }

        #{$block-class}-element__title > div {
          margin: 0 0 $spacing-03;
          > h2 {
            @include carbon--type-style('productive-heading-02');
            order: 1;
          }
        }
      }
    }

    // FOOTER
    &__footer {
      align-items: center;
      display: flex;
      justify-content: flex-end;
    }
    /* ------------------ */

    // THEME
    &__light {
      .#{$block-class}__body {
        .bx--link {
          color: $inverse-link;

          &:hover {
            color: #a6c8ff;
          }
          &:active {
            color: $text-04;
          }
          &:focus {
            outline-color: $text-04;
          }
        }

        .bx--btn--ghost {
          &:hover {
            background-color: $inverse-hover-ui;
          }
          &:active {
            background-color: $active-secondary;
          }
        }
      }
    }
    &__dark {
      .#{$block-class}__body {
        .bx--link {
          color: #0062fe;

          &:hover {
            color: #0043ce;
          }
          &:active {
            color: $link-02;
          }
          &:focus {
            color: $inverse-01;
            outline-color: $inverse-01;
          }
        }

        .bx--btn--primary {
          &:focus {
            background-color: $button-primary-active;
            box-shadow: inset 0 0 0 $spacing-01 $interactive-01,
              inset 0 0 0 rem(3px) $interactive-03;
          }
        }

        .bx--btn--ghost {
          &:hover {
            background-color: $inverse-hover-ui;
          }
          &:active {
            background-color: $button-tertiary-active;
          }
          &:focus {
            box-shadow: inset 0 0 0 $spacing-01 $interactive-01,
              inset 0 0 0 rem(3px) $interactive-03;
          }
        }
      }
    }
    .#{$carousel-class}__item {
      flex: 0 0 100% !important;
    }
  }
}

@include exports('coachmark-overlay') {
  @include coachmark-overlay;
}
