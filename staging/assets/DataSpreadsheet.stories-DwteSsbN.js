import{p as we,j as H}from"./settings-B0yoEqB-.js";import{r as l,R as on}from"./index-BwDkhjyp.js";import{useMDXComponents as Kt}from"./index-DlpNa54Y.js";import"./chunk-HLWAVYOI-BlhN3EDn.js";import{e as cn,i as un,C as ln}from"./index-Bmx3d1TN.js";import{c as ye}from"./useMergedRefs-CY5AfkP4.js";import{O as mn,a as dn}from"./index-CRLQHgyt.js";import{d as me,a as xe,i as wt,h as hn,b as pn,F as fn,s as Ft,u as wn,r as ve}from"./useMultipleKeyTracking-CM-opDjZ.js";import{P as o}from"./index-Dk74W0Oi.js";import{p as re,a as gn,c as gt,d as yn,e as bn,f as xn}from"./index-Di2vWyb4.js";import{u as ze}from"./uuidv4-BQrI85uz.js";import{p as Je}from"./props-helper-TFaonUid.js";import{u as Ye}from"./usePreviousValue-DDnp_zt4.js";import{g as Sn}from"./devtools-Cvhd47uB.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-CJvxHwuA.js";import"./events-D6dlm1BF.js";import"./index-D2JPet7M.js";import"./index-BONylQH5.js";import"./iframe-BT2AViU2.js";import"../sb-preview/runtime.js";import"./react-18-Dd3bHtks.js";import"./extends-CCbyfPlC.js";import"./index-C2eUe6cH.js";import"./index-C0xX6qoh.js";import"./index-DrFu-skq.js";import"./Text-CiWJR74P.js";import"./index-D0hq9jV7.js";import"./useAttachedMenu-BaaFYui-.js";import"./bucket-12-DR0XAE11.js";import"./wrapFocus-CuszVIVc.js";import"./mergeRefs-CTUecegF.js";const Dn=()=>{const[t,e]=l.useState(document.activeElement),r=()=>{e(document.activeElement)};return l.useEffect(()=>(document.addEventListener("focusin",r),()=>{document.removeEventListener("focusin",r)}),[]),t},$e=t=>{const e=Math.max(t.point1.row,t.point2.row),r=Math.max(t.point1.column,t.point2.column),a=Math.min(t.point1.row,t.point2.row),s=Math.min(t.point1.column,t.point2.column);return{greatestRowIndex:e,greatestColumnIndex:r,lowestColumnIndex:s,lowestRowIndex:a}},yt=({ref:t,area:e,blockClass:r,defaultColumn:a,selectionAreas:s,setSelectionAreas:d,setActiveCellInsideSelectionArea:c,visibleColumns:m})=>{const{lowestColumnIndex:i,lowestRowIndex:h,greatestColumnIndex:S,greatestRowIndex:A}=$e(e);(A-h>0||S-i>0)&&(c(!0),t.current.querySelector(`.${r}__active-cell--highlight`).setAttribute("data-selection-id",e.matcher));let p=0;m.forEach((w,T)=>{T>=i&&T<=S&&(p+=(w==null?void 0:w.width)||(a==null?void 0:a.width))});const u=(document.querySelector(`[data-row-index="${e.point1.row}"][data-column-index="${e.point1.column}"]`)||document.querySelector(`.${r}__body--td`)).offsetHeight,y=u*(A-h+1),D=document.querySelector(`.${r}__list--container`).firstElementChild,O=D.querySelector(`[data-row-index="${h}"][data-column-index="${i}"]`),q={top:O?O.getBoundingClientRect().top-D.getBoundingClientRect().top:h===0?0:u*h,left:O?O.getBoundingClientRect().left-D.getBoundingClientRect().left:i===0?0+(a.rowHeaderWidth-4):a.width*i+(a.rowHeaderWidth-4)},N=document.querySelector(`[data-matcher-id="${e.matcher}"]`)||document.createElement("div");N.classList.add(`${r}__selection-area--element`),N.setAttribute("data-matcher-id",e.matcher),N.style.width=re(p),N.style.height=re(y),N.style.left=re(q.left),N.style.top=re(q.top),D.appendChild(N);const I=me(s),B=I.findIndex(w=>w.matcher===e.matcher);I[B].areaCreated=!0,d(I)},Ce=(t,e,r)=>{const a=me(e),s=[];a.forEach(c=>{var h,S,A,p;const m=Math.max((h=c.point1)==null?void 0:h[r],(S=c.point2)==null?void 0:S[r]),i=Math.min((A=c.point1)==null?void 0:A[r],(p=c.point2)==null?void 0:p[r]);for(let f=i;f<=m;f++)s.push(f)});const d=[...new Set(s)];return!!(a!=null&&a.length&&d.includes(t))},Rt=(t,e,r,a)=>me(e).some(c=>{var f,u,y,D,O,q,N,I;const m=r==="column"?"row":"column",i=Math.min((f=c==null?void 0:c.point1)==null?void 0:f[m],(u=c==null?void 0:c.point2)==null?void 0:u[m]),h=Math.max((y=c==null?void 0:c.point1)==null?void 0:y[m],(D=c==null?void 0:c.point2)==null?void 0:D[m]),S=Math.min((O=c==null?void 0:c.point1)==null?void 0:O[r],(q=c==null?void 0:c.point2)==null?void 0:q[r]),A=Math.max((N=c==null?void 0:c.point1)==null?void 0:N[r],(I=c==null?void 0:c.point2)==null?void 0:I[r]),p=(a==null?void 0:a.length)-1===h&&i===0;for(let B=S;B<=A;B++)if(t===B&&p)return!0;return!1}),Xt=({type:t,headerGroup:e,scrollBarSizeValue:r,totalVisibleColumns:a,defaultColumn:s,totalColumnsWidth:d,visibleColumns:c})=>{const m=r+s.rowHeaderWidth;if(!a){if(t==="header")return re(parseInt(e.getHeaderGroupProps().style.width)+m);if(t!=="header")return d+m}if(a)return c.map((h,S)=>S<=a-1&&((h==null?void 0:h.width)||(s==null?void 0:s.width))).reduce((h,S)=>h+S,0)+m},An=({spreadsheetRef:t,activeCellCoordinates:e,containerHasFocus:r,createActiveCell:a,activeCellContent:s,isActiveHeaderCellChanged:d})=>{let c;l.useEffect(()=>{c()},[s,c,d]),c=l.useCallback(()=>{const m=t==null?void 0:t.current.querySelector(`[data-row-index="${e==null?void 0:e.row}"][data-column-index="${e==null?void 0:e.column}"]`),i=(e==null?void 0:e.row)==="header"&&!0,h=t==null?void 0:t.current.querySelector('[data-row-index="header"][data-column-index="header"]');r&&a({placementElement:e?m:h,coords:e,addToHeader:i})},[t,e,r,a])},_n=({blockClass:t=`${we.prefix}--data-spreadsheet`,focusedElement:e,removeActiveCell:r,setContainerHasFocus:a})=>{l.useEffect(()=>{e.classList.contains(`${t}--interactive-cell-element`)||(a(!1),r()),(e.classList.contains(t)||e.classList.contains(`${t}--interactive-cell-element`))&&a(!0)},[e,r,t,a])},Hn=({isBlurSpreadsheet:t,spreadsheetRef:e,blockClass:r=`${we.prefix}--data-spreadsheet`,setActiveCellCoordinates:a,setSelectionAreas:s,removeActiveCell:d,setContainerHasFocus:c,removeCellEditor:m})=>{l.useEffect(()=>{const i=h=>{!e.current||e.current.contains(h.target)||h.target.classList.contains(`${r}__active-cell--highlight`)||h.target.classList.contains(`${r}--interactive-cell-element`)||(t.current=!0,a(null),s([]),d(),xe({spreadsheetRef:e}),c(!1))};return document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}},[t,e,d,r,a,c,s,m])},Tn=({isEditing:t,rows:e,activeCellCoordinates:r,activeCellRef:a,cellEditorRef:s,cellEditorRulerRef:d,visibleColumns:c,defaultColumn:m,cellEditorValue:i,blockClass:h=`${we.prefix}--data-spreadsheet`})=>{const[S,A]=l.useState(null),p=Ye({nextIndex:S});l.useEffect(()=>{p!=null&&p.nextIndex||A(r==null?void 0:r.column)},[p==null?void 0:p.nextIndex,r]),l.useEffect(()=>{var y,D,O,q,N;const f=d.current.offsetWidth,u=parseInt(s.current.style.width);if(t){const I=(y=e[r==null?void 0:r.row])==null?void 0:y.cells[r==null?void 0:r.column],B=a==null?void 0:a.current.style.left,w=a==null?void 0:a.current.style.top;if(s.current.style.left=B,s.current.style.top=w,s.current.style.display="block",s.current.style.height=a==null?void 0:a.current.style.height,s.current.style.paddingTop=`${(parseInt(a==null?void 0:a.current.style.height)-16)/2-1}px`,s.current.style.textAlign=((D=I==null?void 0:I.column)==null?void 0:D.placement)==="right"?"right":"left",(O=s.current)==null||O.focus(),f<u){const T=((q=c[S])==null?void 0:q.width)||(m==null?void 0:m.width);f<u-T&&(s.current.style.width=re(parseInt(s.current.style.width)-T),A(V=>V===0?V:V-1))}if(f>=u){A(U=>U===c.length-1?U:U+1);const V=S+1===c.length?0:((N=c[S+1])==null?void 0:N.width)||(m==null?void 0:m.width),M=r==null?void 0:r.row,Q=(e.length-M)*m.rowHeight;s.current.style.maxHeight=re(Q),s.current.style.width=re(V+u),s.current.style.height=re(s.current.scrollHeight),s.current.clientHeight===Q-1?s.current.style.overflow="auto":s.current.style.overflow="hidden"}}t||(s.current.style.overflow="hidden",s.current.style.display="none",s.current.blur(),a.current.focus(),A(r==null?void 0:r.column))},[t,r,e,i,m,a,s,d,c,h,p==null?void 0:p.cellEditorValue,S])},In=({currentMatcher:t,setSelectionAreas:e,selectedHeaderReorderActive:r,setSelectedHeaderReorderActive:a,setClickAndHoldActive:s,setValidStartingPoint:d,validStartingPoint:c,blockClass:m=`${we.prefix}--data-spreadsheet`,ref:i,setHeaderCellHoldActive:h,setColumnOrder:S,visibleColumns:A,setActiveCellCoordinates:p,activeCellCoordinates:f,rows:u,defaultColumn:y,selectionAreas:D})=>{l.useEffect(()=>{const O=q=>{var I,B;let N=!1;if((I=D==null?void 0:D[0])!=null&&I.header&&D[0].header.type==="column"&&(N=!0),!c&&N){h(!1);const w=i.current.querySelector(`.${m}__selection-area--element`),T=i.current.querySelector(`.${m}__selection-area--element-cloned`);if(!T)return;if(T){const V=q.target.closest(`.${m}--interactive-cell-element`),M=parseInt==null?void 0:parseInt(V==null?void 0:V.getAttribute("data-column-index")),z=parseInt==null?void 0:parseInt(T==null?void 0:T.getAttribute("data-column-index-original")),U=D.filter(K=>(K==null?void 0:K.matcher)===t)[0].header.selectedIndexList;if(!i.current.querySelector(`[data-row-index="header"][data-column-index="${M}"]`))return;const n=i.current.querySelector(`[data-matcher-id="${t}"]`),$=i.current.getBoundingClientRect(),P=i.current.querySelector(`.${m}__list--container`).scrollLeft,E=M<z,j=M>z,ie=j?M-z:z-M;if(e(K=>{const k=me(K);if(z===M)return K;const Y=k.findIndex(ee=>ee.matcher===t);if(Y===-1)return K;if(!U.includes(M)){const ee=j?U.map(ae=>ae+ie):U.map(ae=>ae-ie);k[Y].header.selectedIndexList=ee,k[Y].point1.column=Math.min(...ee),k[Y].point2.column=Math.max(...ee)}return k[Y].areaCreated=!1,k}),!U.includes(M)){const K=U.length,k=Math.min(...U),Y=A.map(L=>L.id),ee=[...Y],ae=()=>{const L=[];return U.map(W=>L.push(Y[W])),L};ee.splice(k,K);const de=U.findIndex(L=>L===z),ge=M-de;ee.splice(ge,0,...ae()),S(ee);const be={...f,column:j?f.column+ie:f.column-ie};p(be);const ce=Array.from(i.current.querySelectorAll(`.${m}__th--selected-header`))[0].getBoundingClientRect().left-$.left+P,x=E?ce:M===z?n.style.left:ce;n.style.left=re(x)}const le=i.current.querySelector(`.${m}__reorder-indicator-line`);le==null||le.remove(),T==null||T.remove(),(B=w==null?void 0:w.classList)==null||B.remove(`${m}__selection-area--element`),a(!1)}}if(c||q.type==="mouseup"){s(!1),d(!1);const w=q.target.closest(`.${m}__body--td`);if(w){const T={row:Number(w.getAttribute("data-row-index")),column:Number(w.getAttribute("data-column-index"))};e(V=>{const M=me(V),z=M.findIndex(Q=>Q.matcher===t);return z===-1?V:(M[z].point2=T,M[z].areaCreated=!1,M)})}}};return document.addEventListener("mouseup",O),()=>{document.removeEventListener("mouseup",O)}},[m,t,e,s,d,c,r,a,i,h,S,A,p,f,u,y,D])},$n=({blockClass:t=`${we.prefix}--data-spreadsheet`,clonedSelectionElement:e,ref:r,spreadsheetCoords:a,leftScrollAmount:s})=>{const d=event.target.closest(`.${t}--interactive-cell-element`),c=d==null?void 0:d.getAttribute("data-column-index"),m=e==null?void 0:e.getAttribute("data-column-index-original"),i=d.getBoundingClientRect(),h=r.current.querySelector(`.${t}__reorder-indicator-line`),S=e==null?void 0:e.getAttribute("data-matcher-id"),A=r.current.querySelector(`[data-matcher-id="${S}"]`),p=r.current.querySelector(`.${t}__list--container`),f=10,u=120,y=100,{clientX:D}=event,{left:O,right:q}=p.getBoundingClientRect();if(D<u&&window.scrollBy(-f,0),D>window.innerWidth-y&&window.scrollBy(f,0),D>O&&D<O+u&&p.scrollBy(-f,0),D<q&&D>q-y&&p.scrollBy(f,0),Number(c)>Number(m)){const N=i.left-a.left+d.offsetWidth-2+s;h.style.left=re(N)}if(Number(c)<Number(m)){const N=i.left-a.left+s;h.style.left=re(N)}Number(c)===Number(m)&&(h.style.left=A.style.left)},qn=({ref:t,blockClass:e=`${we.prefix}--data-spreadsheet`,headerCellHoldActive:r,defaultColumn:a})=>{l.useEffect(()=>{const s=c=>{const m=t.current.querySelector(`.${e}__selection-area--element-cloned`);m&&t.current.addEventListener("mousemove",s);const i=t.current.getBoundingClientRect(),h=t.current.querySelector(`.${e}__list--container`),S=h.scrollLeft;$n({clonedSelectionElement:m,ref:t,spreadsheetCoords:i,leftScrollAmount:S}),t.current.getBoundingClientRect();const p=c.clientX-i.left,f=m==null?void 0:m.getAttribute("data-clone-offset-x"),u=h.scrollWidth,y=m.offsetWidth,D=Math.max(p-f,a==null?void 0:a.rowHeaderWidth),O=u-y>=D?D+S:u-y;O<i.right-40&&(m.style.left=re(O))};r&&t.current.addEventListener("mousemove",s);const d=t.current;return r||d==null||d.removeEventListener("mousemove",s),()=>{d==null||d.removeEventListener("mousemove",s)}})},Ue=(t,e)=>e=="cmd"?t.metaKey||t.ctrlKey:t[e],Mn=({indexList:t,newIndex:e,activeCellIndex:r})=>{const a=e>r?r:Math.min(...t,e),s=e<r?r:Math.max(...t,e),d=[];for(let c=a;c<=s;c++)d.push(c);return[...d]},Qe=({type:t,activeCellCoordinates:e,rows:r,columns:a,currentMatcher:s,setActiveCellCoordinates:d,setCurrentMatcher:c,setSelectionAreas:m,spreadsheetRef:i,index:h,isKeyboard:S,setSelectionAreaData:A,isHoldingCommandKey:p,isHoldingShiftKey:f})=>{p||(A([]),xe({spreadsheetRef:i}));const u=S?e==null?void 0:e.row:h,y=S?e==null?void 0:e.column:h,D={row:t==="column"?0:u,column:t==="column"?y:0},O={row:t==="column"?r.length-1:u,column:t==="column"?y:a.length-1},q=ze();f||(d({row:t==="column"?0:u,column:t==="column"?y:0}),c(q));const N={point1:D,point2:O,areaCreated:!1,matcher:q,header:{type:t,selectedIndexList:[t==="column"?y:u]}};m(I=>{var w,T;const B=me(I);if(p){const M=B.filter(Q=>{var U;return(U=Q.header)==null?void 0:U.type}).filter(Q=>{var U;return((U=Q.header)==null?void 0:U.type)===t}),z=Ce(h,M,t);return M.length&&z?I:[...I,N]}if(f){const M=B.filter(E=>{var j;return(j=E.header)==null?void 0:j.type}).filter(E=>E.matcher===s)[0],z=Math.max(M==null?void 0:M.point1[t],M==null?void 0:M.point2[t],e==null?void 0:e[t]),Q=t==="column"?y:u,U={row:z<Q?r.length-1:0,column:y},C=me(I),n=C.findIndex(E=>E.matcher===s),$=Mn({indexList:((T=(w=C[n])==null?void 0:w.header)==null?void 0:T.selectedIndexList)||[t==="column"?y:u],newIndex:Q,activeCellIndex:e==null?void 0:e[t]}),X=E=>E<Q?{row:t==="column"?0:Math.min(...$),column:t==="column"?Math.min(...$):0}:U,P=E=>E<Q?U:{row:t==="column"?r.length-1:Math.max(...$),column:t==="column"?Math.max(...$):a.length-1};if(!e||typeof e>"u"){c(q);const E={point1:X(t==="column"?y:u),point2:P(t==="column"?y:u),areaCreated:!1,matcher:q,header:{type:t,selectedIndexList:[t==="column"?y:u]}};return d({row:t==="column"?0:u,column:t==="column"?y:0}),[E]}return C[n].point1=X(e==null?void 0:e[t]),C[n].point2=P(e==null?void 0:e[t]),C[n].areaCreated=!1,C[n].header.selectedIndexList=$,C}return[N]})},jn=({activeCellInsideSelectionArea:t,activeCellCoordinates:e,activeCellRef:r,selectionAreas:a,updateActiveCellCoordinates:s})=>{if(!t)return;const d=r.current.getAttribute("data-selection-id"),c=a.findIndex(f=>f.matcher===d),m=a[c],{lowestColumnIndex:i,lowestRowIndex:h,greatestColumnIndex:S,greatestRowIndex:A}=$e(m),p={...e};if((e==null?void 0:e.row)<A&&s({coords:p,updatedValue:{row:(p==null?void 0:p.row)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.row)===A&&((e==null?void 0:e.column)<S&&s({coords:p,updatedValue:{column:(p==null?void 0:p.column)+1,row:h},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.column)===S)){if(a.length>1)if(a[c+1]){r.current.setAttribute("data-selection-id",a[c+1].matcher);const f=a[c+1],{lowestColumnIndex:u,lowestRowIndex:y}=$e(f);s({coords:p,updatedValue:{column:u,row:y},optOutOfSelectionAreaUpdate:!0});return}else{r.current.setAttribute("data-selection-id",a[0].matcher);const f=a[0],{lowestColumnIndex:u,lowestRowIndex:y}=$e(f);s({coords:p,updatedValue:{column:u,row:y},optOutOfSelectionAreaUpdate:!0})}if(a.length===1)return s({coords:p,updatedValue:{column:i,row:h},optOutOfSelectionAreaUpdate:!0})}},On=({activeCellInsideSelectionArea:t,activeCellCoordinates:e,activeCellRef:r,selectionAreas:a,updateActiveCellCoordinates:s})=>{if(!t)return;const d=r.current.getAttribute("data-selection-id"),c=a.findIndex(p=>p.matcher===d),m=a[c],{lowestColumnIndex:i,lowestRowIndex:h,greatestColumnIndex:S,greatestRowIndex:A}=$e(m);if((e==null?void 0:e.column)<S&&s({updatedValue:{column:(e==null?void 0:e.column)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.column)===S&&((e==null?void 0:e.row)<A&&s({updatedValue:{column:i,row:(e==null?void 0:e.row)+1},optOutOfSelectionAreaUpdate:!0}),(e==null?void 0:e.row)===A)){if(a.length>1)if(a[c+1]){r.current.setAttribute("data-selection-id",a[c+1].matcher);const p=a[c+1],{lowestColumnIndex:f,lowestRowIndex:u}=$e(p);s({updatedValue:{column:f,row:u},optOutOfSelectionAreaUpdate:!0});return}else{r.current.setAttribute("data-selection-id",a[0].matcher);const p=a[0],{lowestColumnIndex:f,lowestRowIndex:u}=$e(p);s({updatedValue:{column:f,row:u},optOutOfSelectionAreaUpdate:!0})}if(a.length===1)return s({updatedValue:{column:i,row:h},optOutOfSelectionAreaUpdate:!0})}},bt=(t,e,r)=>{for(let a=t;a<=e;a++)r(a)},kn=({activeCellCoordinates:t,selectionAreas:e,currentMatcher:r,rows:a,setActiveCellContent:s,updateData:d})=>{var f,u,y,D,O,q,N,I;if((t==null?void 0:t.column)==="header"||(t==null?void 0:t.row)==="header")return;const c=me(e),m=c.findIndex(B=>B.matcher===r),i=c[m],h=Math.min((f=i==null?void 0:i.point1)==null?void 0:f.column,(u=i==null?void 0:i.point2)==null?void 0:u.column),S=Math.max((y=i==null?void 0:i.point1)==null?void 0:y.column,(D=i==null?void 0:i.point2)==null?void 0:D.column),A=Math.min((O=i==null?void 0:i.point1)==null?void 0:O.row,(q=i==null?void 0:i.point2)==null?void 0:q.row),p=Math.max((N=i==null?void 0:i.point1)==null?void 0:N.row,(I=i==null?void 0:i.point2)==null?void 0:I.row);bt(h,S,B=>{bt(A,p,w=>{const T=a[w].cells[B];d(w,T==null?void 0:T.column.id,"")})}),s(null)},Xe=`${we.prefix}--data-spreadsheet`,Ln=(t,e,r,...a)=>{const[s,d,c,m,i,h,S,A,p,f,u,y,D]=a;r.preventDefault();const q=r.target.closest(`.${Xe}__body--td`).classList.contains(`${Xe}__body--td`);D(q);const N=Ue(r,"cmd"),I=Ue(r,"shiftKey");h(!0);const B={row:t.row.index,column:e},w=ze();if(S(!0),N)p.current.querySelector(`.${Xe}__active-cell--highlight`).setAttribute("data-selection-id",w),u(!0),m(B),A(w),i(V=>[...V,{point1:B,matcher:w}]);else if(I){h(!0);const T=me(c),V=T.findIndex(M=>M.matcher===s);if(V===-1)return;T[V].point1=d,T[V].point2=B,T[V].areaCreated=!1,T[V].matcher=s,i(T)}else y.current.style.display="none",u(!1),m(B),xe({spreadsheetRef:p}),i([{point1:B,matcher:w}]),A(w),f([])},Nn=(t,e,...r)=>{const[a,s,d]=r;if(a){const c={row:t.row.index,column:e};d(m=>{var S,A;const i=me(m),h=i.findIndex(p=>p.matcher===s);return h===-1||((S=i[h].point2)==null?void 0:S.row)===c.row&&((A=i[h].point2)==null?void 0:A.column)===c.column?m:(i[h].point2=c,i[h].areaCreated=!1,i)})}},Pn=(t,e,...r)=>{const[a,s,d,c,m,i,h,S]=r,A=Ue(e,"cmd");Qe({type:"row",activeCellCoordinates:i,rows:h,columns:a,setActiveCellCoordinates:m,setCurrentMatcher:c,setSelectionAreas:d,spreadsheetRef:s,index:t,setSelectionAreaData:S,isHoldingCommandKey:A})},Wn=(t,...e)=>{const[r,a,s,d,c,m,i,h,S,A,p,f,u,y,D,O,q,N,I,B,w,T,V]=e,{key:M}=t;if(!D(M)&&(["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(M)>-1&&A!=null&&A.length&&f.length<2&&!wt(f)&&(q([]),N([]),xe({spreadsheetRef:i})),(f==null?void 0:f.length)>1&&hn({activeCellCoordinates:s,event:t,keysPressedList:f,selectionAreas:A,currentMatcher:h,rows:m,setSelectionAreas:q,columns:c,updateActiveCellCoordinates:a,spreadsheetRef:i,removeCellSelections:xe,blockClass:Xe,setCurrentMatcher:I,usingMac:u}),f.length<2&&!wt(f)||s.row==="header"||s.column==="header"))switch(M){case"Backspace":case"Delete":{kn({selectionAreas:A,currentMatcher:h,rows:m,setActiveCellContent:V,updateData:y,activeCellCoordinates:s});break}case"Enter":{jn({activeCellInsideSelectionArea:r,activeCellCoordinates:s,activeCellRef:B,selectionAreas:A,updateActiveCellCoordinates:a});break}case"Home":case"End":{if(t.preventDefault(),pn(f,u))return;p({type:M});break}case"Tab":{if(r)return t.preventDefault(),On({activeCellInsideSelectionArea:r,activeCellCoordinates:s,activeCellRef:B,selectionAreas:A,updateActiveCellCoordinates:a});q([]),d(),S(),T(!1),w(null);break}case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":O(M)}},J=`${we.prefix}--data-spreadsheet`,et=l.forwardRef(({activeCellRef:t,columns:e,activeCellCoordinates:r,defaultColumn:a,defaultEmptyRowCount:s,getTableBodyProps:d,headerGroups:c,setCurrentColumns:m,id:i,onDataUpdate:h,renderRowHeader:S,renderRowHeaderDirection:A,hasCustomRowHeader:p,prepareRow:f,rows:u,selectionAreaData:y,setSelectionAreaData:D,setActiveCellCoordinates:O,selectedHeaderReorderActive:q,setSelectedHeaderReorderActive:N,selectionAreas:I,setContainerHasFocus:B,setSelectionAreas:w,scrollBarSize:T,totalColumnsWidth:V,clickAndHoldActive:M,setClickAndHoldActive:z,currentMatcher:Q,setCurrentMatcher:U,onSelectionAreaChange:C,setActiveCellInsideSelectionArea:n,totalVisibleColumns:$,setHeaderCellHoldActive:X,setColumnOrder:P,visibleColumns:E},j)=>{const[ie,le]=l.useState(!1),K=l.useRef(),k=Ye({selectionAreaData:y,clickAndHoldActive:M,rowHeight:a==null?void 0:a.rowHeight})||{};l.useEffect(()=>{j==null||j.current.style.setProperty(`--${J}--total-width`,re((V||0)+(T||0)))},[j,T,V]),l.useEffect(()=>{var x,L,W,Z;if(y!=null&&y.length){let _=!1;(((x=k==null?void 0:k.selectionAreaData)==null?void 0:x.length)!==(y==null?void 0:y.length)||((L=y==null?void 0:y[0])==null?void 0:L.cells.length)!==((Z=(W=k==null?void 0:k.selectionAreaData)==null?void 0:W[0])==null?void 0:Z.cells.length))&&(_=!0),(!M&&(k!=null&&k.clickAndHoldActive)||_)&&(C==null||C(y))}},[k==null?void 0:k.selectionAreaData,y,C,M,k==null?void 0:k.clickAndHoldActive]),l.useEffect(()=>{I&&I.length&&I.map(x=>{if(x.areaCreated){const L=Math.min(x.point1.row,x.point2.row),W=Math.max(x.point1.row,x.point2.row),Z=Math.min(x.point1.column,x.point2.column),_=Math.max(x.point1.column,x.point2.column),G={rows:{start:L,end:W},columns:{start:Z,end:_},cells:Y({rowStart:L,rowEnd:W,columnStart:Z,columnEnd:_}),selectionId:x.matcher};D==null||D(R=>[...me(R).filter(he=>he.selectionId!==x.matcher),G])}!x.areaCreated&&x.point1&&x.point2&&x.matcher&&yt({ref:j,area:x,blockClass:J,defaultColumn:a,selectionAreas:I,setSelectionAreas:w,setActiveCellInsideSelectionArea:n,visibleColumns:E})})},[I,w,a,C,D,j,r,n,E,p]);const Y=({rowStart:x,rowEnd:L,columnStart:W,columnEnd:Z})=>{const _=[];for(let G=x;G<=L;G++)for(let R=W;R<=Z;R++)_.push([G,R,`${J}__cell--${G}--${R}`]);return _};In({currentMatcher:Q,setClickAndHoldActive:z,setSelectionAreas:w,setValidStartingPoint:le,selectedHeaderReorderActive:q,setSelectedHeaderReorderActive:N,validStartingPoint:ie,ref:j,setHeaderCellHoldActive:X,setColumnOrder:P,visibleColumns:E,setActiveCellCoordinates:O,rows:u,activeCellCoordinates:r,defaultColumn:a,selectionAreas:I}),l.useEffect(()=>{let x,L;if(ce!=null&&ce.current&&(x=ce==null?void 0:ce.current,L=x==null?void 0:x.querySelector(`.${J}__active-cell--highlight`)),L&&(a==null?void 0:a.rowHeight)!==k.rowHeight&&(L.style.height=`${a==null?void 0:a.rowHeight}px`,r)){const W=j==null?void 0:j.current.querySelector(`[data-row-index="${r.row}"][data-column-index="${r.column}"]`),Z=j==null?void 0:j.current.querySelector(`.${J}__list--container`);let _;W&&Z&&(_=(W==null?void 0:W.getBoundingClientRect().top)-Z.getBoundingClientRect().top),L.style.top=re(_),xe({matcher:void 0,spreadsheetRef:j}),I==null||I.map(G=>{if(!G.areaCreated&&G.point1&&G.point2&&G.matcher)return yt({ref:j,area:G,blockClass:J,defaultColumn:a,selectionAreas:I,setSelectionAreas:w,setActiveCellInsideSelectionArea:n,visibleColumns:E})})}},[a,j,r,k==null?void 0:k.rowHeight,I,n,w,E,p]);const ee=l.useCallback(()=>{const x=[],L=[];j==null||j.current.querySelectorAll(`.${J}__selection-area--element`).forEach(W=>{const{top:Z,left:_,height:G,width:R}=W.style,fe=`${Z}${_}${G}${R}`;x.indexOf(fe)==-1?x.push(fe):(W.remove(),L.push(W.getAttribute("data-matcher-id")))}),L.length&&(w==null||w(W=>me(W).filter(_=>!L.includes(_.matcher))),D==null||D(W=>me(W).filter(_=>!L.includes(_.selectionId))))},[j,w,D]);l.useEffect(()=>{ee()},[I,ee]);const ae=l.useCallback((x,L)=>W=>{Ln(x,L,W,Q,r,I,O,w,B,z,U,j,D,n,t,le)},[Q,r,I,O,w,B,z,U,j,D,n,t]),de=()=>{const x=j.current.querySelector(`
        .${J}__header--container .${J}__tr`)||new HTMLDivElement;x.scrollLeft=K==null?void 0:K.current.scrollLeft};l.useEffect(()=>{K.current.addEventListener("scroll",()=>de());const x=K.current||new HTMLElement;return()=>{x.removeEventListener("scroll",de)}});const ge=l.useCallback((x,L)=>()=>{Nn(x,L,M,Q,w)},[M,Q,w]),be=l.useCallback(x=>L=>{Pn(x,L,e,j,w,U,O,r,u,D)},[e,j,w,U,O,r,u,D]);l.useEffect(()=>{if(u!=null&&u.length||(()=>{const L=[];[...Array(s)].map(()=>{var Z;const W={};(Z=c==null?void 0:c[0])==null||Z.headers.map(_=>{W[_.id]=null}),L.push(W)}),h==null||h(L)})(),c!=null&&c[0]&&typeof m=="function"){const x=c[0].headers;m(x)}},[u,c,s,h,m]);const Se=()=>H.jsx("div",{}),Ae=l.useCallback(({index:x,style:L})=>{const W=u==null?void 0:u[x];if(u&&u.length){f==null||f(W);const Z=Je(W.getRowProps({style:L}),"key");return H.jsxs("div",{...Z,className:ye(`${J}__tr`),"data-row-index":x,"aria-rowindex":x+1,"aria-owns":`${J}__cell-editor-text-area`,children:[H.jsx("div",{role:"rowheader",className:`${J}__td-th--cell-container`,children:H.jsxs("button",{id:`${J}__cell--${x}--header`,tabIndex:-1,"data-row-index":x,"data-column-index":"header",type:"button",onClick:be(x),className:ye(`${J}__td`,`${J}__td-th`,`${J}--interactive-cell-element`,{[`${J}__td_custom`]:!!p,[`${J}__td-th--active-header`]:!p&&((r==null?void 0:r.row)===x||Ce(x,I,"row")),[`${J}__td-th--selected-header`]:!p&&Rt(x,I,"row",e)}),style:{width:a==null?void 0:a.rowHeaderWidth,flexDirection:p?A==="Left"?"row-reverse":W:void 0},children:[x+1,p&&typeof S=="function"&&S(x)]})}),W.cells.map((_,G)=>{var fe;const R=Je(_.getCellProps(),"key");return H.jsx("div",{"aria-colindex":G+1,...R,role:"gridcell",style:{..._.getCellProps().style,display:"grid",minWidth:((fe=_==null?void 0:_.column)==null?void 0:fe.width)||(a==null?void 0:a.width)},children:H.jsx("button",{id:`${J}__cell--${_.row.index}--${G}`,tabIndex:-1,"data-row-index":_.row.index,"data-column-index":G,className:ye(`${J}__td`,`${J}__body--td`,`${J}--interactive-cell-element`),onMouseDown:ae(_,G),onMouseOver:ge(_,G),onFocus:()=>{},type:"button",children:_.render("Cell")})},`cell_${G}`)})]},{...W.getRowProps().key})}},[f,S,A,u,p,r==null?void 0:r.row,I,be,ae,ge,a,e]),ce=l.useRef();return H.jsx("div",{ref:ce,className:ye(`${J}__body--container`),...d==null?void 0:d(),children:H.jsx(fn,{className:ye(`${J}__list--container`,`${J}__list--container--${i}`),height:400,itemCount:(u==null?void 0:u.length)||s,itemSize:a==null?void 0:a.rowHeight,width:Xt({headerGroup:void 0,type:void 0,scrollBarSizeValue:T,totalVisibleColumns:$,defaultColumn:a,totalColumnsWidth:V,visibleColumns:E}),outerRef:K,children:u!=null&&u.length?Ae:Se})})});et.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.string,o.number]),column:o.oneOfType([o.string,o.number])}),activeCellRef:o.object,clickAndHoldActive:o.bool,columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),defaultEmptyRowCount:o.number,getTableBodyProps:o.func,hasCustomRowHeader:o.bool,headerGroups:o.arrayOf(o.object),id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,prepareRow:o.func,renderRowHeader:o.func,renderRowHeaderDirection:o.string,rows:o.arrayOf(o.object),scrollBarSize:o.number,selectedHeaderReorderActive:o.bool,selectionAreaData:o.array,selectionAreas:o.array,setActiveCellCoordinates:o.func,setActiveCellInsideSelectionArea:o.func,setClickAndHoldActive:o.func,setColumnOrder:o.func,setContainerHasFocus:o.func,setCurrentColumns:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalColumnsWidth:o.number,totalVisibleColumns:o.number,visibleColumns:o.array};et.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetBody",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},column:{name:"union",value:[{name:"string"},{name:"number"}],required:!1}}}},activeCellRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"union",raw:"HTMLElement | undefined",elements:[{name:"HTMLElement"},{name:"undefined"}]}],raw:"MutableRefObject<HTMLElement | undefined>"},description:"This is the ref of the button input, which is the active cell element",type:{name:"object"}},clickAndHoldActive:{required:!1,tsType:{name:"boolean"},description:"Is the user clicking and holding in the data spreadsheet body",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"This represents the id of the current cell selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",type:{name:"number"}},getTableBodyProps:{required:!1,tsType:{name:"signature",type:"function",raw:"(propGetter?: TableBodyPropGetter<any>) => TableBodyProps",signature:{arguments:[{type:{name:"TableBodyPropGetter",elements:[{name:"any"}],raw:"TableBodyPropGetter<any>"},name:"propGetter"}],return:{name:"TableBodyProps"}}},description:"Function to set table body prop values",type:{name:"func"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},setCurrentColumns:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Set current columns after drag drop",type:{name:"func"}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",type:{name:"func"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if user is using custom component",type:{name:"bool"}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},renderRowHeaderDirection:{required:!1,tsType:{name:"string"},description:"Component next to numbering rows",type:{name:"string"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called to set the rows for the empty spreadsheet",type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called when the selection areas change",type:{name:"func"}},prepareRow:{required:!1,tsType:{name:"signature",type:"function",raw:"(...args) => void",signature:{arguments:[{name:"args",rest:!0}],return:{name:"void"}}},description:"Prepare row function from react-table",type:{name:"func"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectionAreaData:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection area data",type:{name:"array"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection areas",type:{name:"array"}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates state value",type:{name:"func"}},setActiveCellInsideSelectionArea:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for active cell inside of selection area",type:{name:"func"}},setClickAndHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for clickAndHold state value",type:{name:"func"}},setColumnOrder:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  updater:
    | ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
    | Array<IdType<any>>
) => void`,signature:{arguments:[{type:{name:"union",raw:`| ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
| Array<IdType<any>>`,elements:[{name:"unknown"},{name:"Array",elements:[{name:"IdType",elements:[{name:"any"}],raw:"IdType<any>"}],raw:"Array<IdType<any>>"}]},name:"updater"}],return:{name:"void"}}},description:"Setter fn for column ordering, provided from react-table",type:{name:"func"}},setContainerHasFocus:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for containerHasFocus state value",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher state value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas state value",type:{name:"func"}},totalColumnsWidth:{required:!1,tsType:{name:"number"},description:"The total columns width",type:{name:"number"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Prop from react-table used to reorder columns",type:{name:"array"}}}};const ne=`${we.prefix}--data-spreadsheet`,tt=l.forwardRef(({activeCellCoordinates:t,cellSize:e,columns:r,currentMatcher:a,defaultColumn:s,headerGroups:d,scrollBarSize:c,selectionAreas:m,selectedHeaderReorderActive:i,setSelectedHeaderReorderActive:h,setActiveCellCoordinates:S,setCurrentMatcher:A,setSelectionAreas:p,readOnlyTable:f,disableColumnSwapping:u,setSelectionAreaData:y,rows:D,totalVisibleColumns:O,updateActiveCellCoordinates:q,setHeaderCellHoldActive:N,headerCellHoldActive:I,selectAllAriaLabel:B,visibleColumns:w},T)=>{const[V,M]=l.useState(0),z=Ye({cellSize:e})||{};l.useEffect(()=>{var n;if((z==null?void 0:z.cellSize)!==e){const $=(n=T==null?void 0:T.current)==null?void 0:n.querySelector(`.${ne}__list--container`),P=($==null?void 0:$.scrollHeight)&&($==null?void 0:$.clientHeight)&&($==null?void 0:$.scrollHeight)>($==null?void 0:$.clientHeight)?0:c;$!=null&&$.getAttribute("tabIndex")||$==null||$.setAttribute("tabIndex","0"),M(P)}},[e,T,c,z==null?void 0:z.cellSize]);const Q=n=>$=>{const X=Ue($,"cmd"),P=Ue($,"shiftKey");Qe({type:"column",activeCellCoordinates:t,rows:D,columns:r,currentMatcher:a,setActiveCellCoordinates:S,setCurrentMatcher:A,setSelectionAreas:p,spreadsheetRef:T,index:n,isKeyboard:void 0,setSelectionAreaData:y,isHoldingCommandKey:X,isHoldingShiftKey:P})},U=()=>{Ft({ref:T,setCurrentMatcher:A,setSelectionAreas:p,rows:D,columns:r,activeCellCoordinates:t,updateActiveCellCoordinates:q})},C=n=>$=>{var ge,be,Se,Ae,ce,x;if($.shiftKey)return;const X=m==null?void 0:m.filter(L=>(L==null?void 0:L.matcher)===a),P=T.current.querySelector(`[data-matcher-id="${(ge=X==null?void 0:X[0])==null?void 0:ge.matcher}"]`);P&&P.classList.add(`${ne}__selection-area--element`),typeof h=="function"&&h(!0);const E=$.clientX,j=$.target.getBoundingClientRect(),ie=$.target.getAttribute("data-column-index"),le=E-j.left,K=Math.min(((Se=(be=X==null?void 0:X[0])==null?void 0:be.point1)==null?void 0:Se.column)||0,((ce=(Ae=X==null?void 0:X[0])==null?void 0:Ae.point2)==null?void 0:ce.column)||0),k=(P==null?void 0:P.getBoundingClientRect())||new DOMRect,Y=K<parseInt(ie)?le+(j.left-(k==null?void 0:k.left)):le,ee=(x=document==null?void 0:document.querySelector(`.${ne}__list--container`))==null?void 0:x.firstElementChild,ae=P==null?void 0:P.cloneNode(),de=P==null?void 0:P.cloneNode();de&&(de.className=`${ne}__reorder-indicator-line`,de.style.width=re(2)),ae.classList.add(`${ne}__selection-area--element-cloned`),ae.setAttribute("data-clone-offset-x",`${Y}`),ae.setAttribute("data-column-index-original",n),ee==null||ee.appendChild(ae),ee==null||ee.appendChild(de),N==null||N(!0)};return qn({ref:T,headerCellHoldActive:I,defaultColumn:s}),H.jsx("div",{className:ye(`${ne}__header--container`),role:"rowgroup",children:d==null?void 0:d.map((n,$)=>{const X=Je(n.getHeaderGroupProps(),"key");return H.jsxs("div",{...X,style:{...n.getHeaderGroupProps().style,width:Xt({type:"header",headerGroup:n,scrollBarSizeValue:V,totalVisibleColumns:O,defaultColumn:s,totalColumnsWidth:void 0,visibleColumns:w}),overflow:"hidden"},className:`${ne}__tr`,children:[H.jsx("div",{role:"columnheader",className:`${ne}__select-all-cell-container`,style:{width:s==null?void 0:s.rowHeaderWidth,height:s==null?void 0:s.rowHeight},children:H.jsx("button",{id:`${ne}__cell--header--header`,"data-row-index":"header","data-column-index":"header",type:"button",style:{width:s==null?void 0:s.rowHeaderWidth},tabIndex:-1,"aria-label":B,onClick:U,className:ye(`${ne}__th`,`${ne}--interactive-cell-element`,`${ne}__th--select-all`,{[`${ne}__th--active-header`]:(t==null?void 0:t.column)==="header"&&(t==null?void 0:t.row)==="header"}),children:" "})}),n.headers.map((P,E)=>{const j=Je(P.getHeaderProps(),"key"),ie=Rt(E,m,"column",D);return H.jsx("div",{role:"columnheader",className:`${ne}__columnheader`,...j,children:H.jsx("button",{id:`${ne}__cell--header--${E}`,"data-row-index":"header","data-column-index":E,tabIndex:-1,onMouseDown:ie&&!f&&!u?C(E):void 0,onMouseUp:ie&&!f&&!u&&typeof h=="function"?()=>h(!1):void 0,onClick:ie?void 0:Q(E),style:{height:s==null?void 0:s.rowHeight,width:(P==null?void 0:P.width)||(s==null?void 0:s.width)},className:ye(`${ne}__th`,`${ne}--interactive-cell-element`,{[`${ne}__th--active-header`]:(t==null?void 0:t.column)===E||Ce(E,m,"column"),[`${ne}__th--active-header-disabledSwapping`]:u||f,[`${ne}__th--selected-header`]:ie,[`${ne}__th--selected-header-reorder-active`]:i}),type:"button",children:P.render("Header")})},`column_${E}`)})]},`header_${$}`)})})});tt.propTypes={activeCellCoordinates:o.shape({row:o.oneOfType([o.number,o.string]),column:o.oneOfType([o.number,o.string])}),cellSize:o.oneOf(["xs","sm","md","lg"]),columns:o.array,currentMatcher:o.string,defaultColumn:o.shape({rowHeight:o.number,rowHeaderWidth:o.number,width:o.number}),disableColumnSwapping:o.bool,headerCellHoldActive:o.bool,headerGroups:o.arrayOf(o.object),readOnlyTable:o.bool,rows:o.arrayOf(o.object),scrollBarSize:o.number,selectAllAriaLabel:o.string.isRequired,selectedHeaderReorderActive:o.bool,selectionAreas:o.arrayOf(o.object),setActiveCellCoordinates:o.func,setCurrentMatcher:o.func,setHeaderCellHoldActive:o.func,setSelectedHeaderReorderActive:o.func,setSelectionAreaData:o.func,setSelectionAreas:o.func,totalVisibleColumns:o.number,updateActiveCellCoordinates:o.func,visibleColumns:o.array};tt.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetHeader",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"number"},{name:"string"}],required:!1},column:{name:"union",value:[{name:"number"},{name:"string"}],required:!1}}}},cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"uuid that corresponds to the current selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},headerCellHoldActive:{required:!1,tsType:{name:"boolean"},description:"Whether or not a click/hold is active on a header cell",type:{name:"bool"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",type:{name:"bool"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"object"}],raw:"object[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"ItemType"}],raw:"ItemType[]"},description:"All of the cell selection area items",type:{name:"arrayOf",value:{name:"object"}}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates value",type:{name:"func"}},selectedHeaderReorderActive:{required:!1,tsType:{name:"boolean"},description:"Header reordering is active",type:{name:"bool"}},setSelectedHeaderReorderActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Set header reordering active or not",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas value",type:{name:"func"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},updateActiveCellCoordinates:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg) => void",signature:{arguments:[{name:"arg"}],return:{name:"void"}}},description:"Function used to update the active cell coordinates",type:{name:"func"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Array of visible columns provided by react-table useTable hook",type:{name:"array"}}}};const Vn=()=>{const t=document.createElement("div");t.setAttribute("style","width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;"),document.body.appendChild(t);const e=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),e},Bn=({placementElement:t,coords:e,addToHeader:r=!1,contextRef:a,blockClass:s=`${we.prefix}--data-spreadsheet`,onActiveCellChange:d,activeCellValue:c,activeCellRef:m,cellEditorRef:i,defaultColumn:h})=>{if(!e)return;const S=document.querySelector(`[data-row-index="${e.row}"][data-column-index="${e.column}"]`)||document.querySelector(`.${s}__body--td`),A=S.offsetWidth,p=S.offsetHeight,f=r?a==null?void 0:a.current.querySelector(`.${s}__header--container`):a==null?void 0:a.current.querySelector(`.${s}__list--container`).firstElementChild,u={top:t?t.getBoundingClientRect().top-f.getBoundingClientRect().top:e.row===0?0:p*e.row,left:t?t.getBoundingClientRect().left-f.getBoundingClientRect().left:e.column===0?0+(h.rowHeaderWidth-4):A*e.column+(h.rowHeaderWidth-4)},y=m==null?void 0:m.current;y.style.width=re(t?t==null?void 0:t.offsetWidth:A),y.style.height=re(t?t==null?void 0:t.offsetHeight:p),y.style.left=re(u.left),y.style.top=re(u.top),y.style.display="block",y.setAttribute("data-active-row-index",typeof(e==null?void 0:e.row)=="number"?e.row:"header"),y.setAttribute("data-active-column-index",typeof(e==null?void 0:e.column)=="number"?e.column:"header"),f.appendChild(y),y.focus(),r||f.appendChild(i.current),typeof(e==null?void 0:e.column)=="number"&&typeof(e==null?void 0:e.row)=="number"&&(d==null||d(c))},Ee=t=>Number(t.replace("rem","")*gn),En=t=>{switch(t){case"xs":return Ee(xn);case"sm":return Ee(gt);case"md":return Ee(bn);case"lg":return Ee(yn);default:return Ee(gt)}},zn=({activeCellCoordinates:t,cellEditorRulerRef:e,columns:r,previousState:a,removeCellEditor:s,rows:d,setActiveCellCoordinates:c,setCurrentMatcher:m,setSelectionAreas:i,spreadsheetRef:h,updateData:S})=>A=>{const{key:p}=A,f=({type:u})=>{const y=()=>{const q=a==null?void 0:a.activeCellCoordinates,N=d[q==null?void 0:q.row].cells[q==null?void 0:q.column];s(),S(q==null?void 0:q.row,N.column.id)};xe({spreadsheetRef:h}),y();const D=ze(),O={row:u==="Enter"?t.row===d.length-1?t.row:t.row+1:t.row,column:u==="Tab"?t.column===r.length-1?t.column:t.column+1:t.column};i([{point1:O,point2:O,matcher:D,areaCreated:!1}]),m(D),e.current.textContent=""};p==="Enter"&&(f({type:"Enter"}),c(u=>({...u,row:u.row===d.length-1?u.row:u.row+1}))),p==="Tab"&&(A.preventDefault(),f({type:"Tab"}),c(u=>({...u,column:u.column===r.length-1?u.column:u.column+1})))},ue=`${we.prefix}--data-spreadsheet`,nt="DataSpreadsheet",Te={columns:Object.freeze([]),data:Object.freeze([]),defaultEmptyRowCount:16,onDataUpdate:Object.freeze(()=>{}),onColDrag:Object.freeze(()=>{}),onActiveCellChange:Object.freeze(()=>{}),onSelectionAreaChange:Object.freeze(()=>{}),theme:"light"};let pe=on.forwardRef(({cellSize:t="sm",className:e,columns:r=Te.columns,data:a=Te.data,defaultEmptyRowCount:s=Te.defaultEmptyRowCount,onDataUpdate:d=Te.onDataUpdate,onColDrag:c=Te.onColDrag,id:m,onActiveCellChange:i=Te.onActiveCellChange,onSelectionAreaChange:h=Te.onSelectionAreaChange,renderRowHeader:S,renderRowHeaderDirection:A,disableColumnSwapping:p=!1,readOnlyTable:f=!1,selectAllAriaLabel:u,spreadsheetAriaLabel:y,theme:D,totalVisibleColumns:O,...q},N)=>{const I=l.useRef(null),B=l.useRef(),w=N||B,T=Dn(),[V,M]=l.useState(r),[z,Q]=l.useState([]),[U,C]=l.useState(!1),[n,$]=l.useState(null),[X,P]=l.useState([]),[E,j]=l.useState([]),[ie,le]=l.useState(!1),[K,k]=l.useState(""),[Y,ee]=l.useState(!1),[ae,de]=l.useState(""),[ge,be]=l.useState(!1),[Se,Ae]=l.useState(!1),ce=l.useRef(!1),[x,L]=l.useState(!1),[W,Z]=l.useState(!1),_=Ye({activeCellCoordinates:n,isEditing:Y,cellEditorValue:ae,selectedHeaderReorderActive:Se})||{},G=En(t),R=l.useRef(),[fe,Me]=l.useState(),he=l.useRef(),te=l.useRef(),Ze=typeof S=="function",rt=a.length.toString().length,je=l.useMemo(()=>({width:150,rowHeaderWidth:Ze?40+rt*8.56:64,rowHeight:G}),[G,Ze,rt]),{keysPressedList:at,usingMac:st}=wn({ref:I,containerHasFocus:U,isEditing:Y}),ot=l.useMemo(()=>Vn(),[]),{getTableProps:Jt,getTableBodyProps:Qt,headerGroups:ct,rows:se,totalColumnsWidth:Yt,prepareRow:Zt,setColumnOrder:Gt,visibleColumns:Ge}=ve.useTable({columns:r,data:a,defaultColumn:je},ve.useBlockLayout,ve.useColumnOrder),Be=l.useCallback((g,b,F)=>{d(v=>v.map((oe,De)=>De===g?{...v[g],[b]:ae||F}:oe))},[ae,d]);l.useEffect(()=>{const g=[];Object.keys(V).length>0&&Object.keys(V).forEach(b=>{V[b].Header&&g.push(V[b].Header)}),_.selectedHeaderReorderActive&&Q(g),!_.selectedHeaderReorderActive&&z.length>0&&!ge&&JSON.stringify(g)!==JSON.stringify(z)&&(c({headers:g,data:fe.props.data}),g.length===0&&Q([]))},[_==null?void 0:_.selectedHeaderReorderActive,V,ge,r,fe,c,z]);const Ke=l.useCallback(()=>{var b;const g=(b=w==null?void 0:w.current)==null?void 0:b.querySelector(`.${ue}__active-cell--highlight`);g&&(g.style.display="none")},[w]),He=l.useCallback(()=>{de(""),ee(!1),R!=null&&R.current&&(R.current.style.display="none")},[]);l.useEffect(()=>{const g=_==null?void 0:_.activeCellCoordinates;if(((g==null?void 0:g.row)!==(n==null?void 0:n.row)||(g==null?void 0:g.column)!==(n==null?void 0:n.column))&&Y){const b=se[Number(g==null?void 0:g.row)].cells[Number(g==null?void 0:g.column)];He(),Be(g==null?void 0:g.row,b.column.id,void 0),te!=null&&te.current&&(te.current.textContent="")}if((g==null?void 0:g.row)!==(n==null?void 0:n.row)||(g==null?void 0:g.column)!==(n==null?void 0:n.column)){if(n&&(n==null?void 0:n.row)!=="header"&&(n==null?void 0:n.column)!=="header"){const b=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?se[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;Me(b?b.render("Cell"):null)}(n&&(n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&(Me(null),L(b=>!b))}Y&&_.activeCellCoordinates&&ce.current&&(Me(_.cellEditorValue),ce.current=!1,He())},[ce,n,_==null?void 0:_.activeCellCoordinates,_==null?void 0:_.cellEditorValue,Be,se,Y,He,fe]);const vt=l.useCallback(({placementElement:g,coords:b,addToHeader:F=!1})=>{const v=typeof(b==null?void 0:b.column)=="number"&&typeof(b==null?void 0:b.row)=="number"?se[b==null?void 0:b.row].cells[b==null?void 0:b.column]:null,oe=v?Object.values(v.row.values)[b==null?void 0:b.column]:null;Bn({placementElement:g,coords:b,addToHeader:F,contextRef:w,blockClass:ue,onActiveCellChange:i,activeCellValue:oe,activeCellRef:he,cellEditorRef:R,defaultColumn:je})},[w,se,i,je]);_n({focusedElement:T,removeActiveCell:Ke,setContainerHasFocus:C}),Hn({isBlurSpreadsheet:ce,spreadsheetRef:w,setActiveCellCoordinates:$,setSelectionAreas:P,removeActiveCell:Ke,setContainerHasFocus:C,removeCellEditor:He}),An({spreadsheetRef:w,activeCellCoordinates:n,containerHasFocus:U,createActiveCell:vt,activeCellContent:fe,isActiveHeaderCellChanged:x});const it=l.useCallback(()=>{Z(!1),n||$({column:"header",row:"header"})},[n]),_e=l.useCallback(({coords:g={...n},updatedValue:b,optOutOfSelectionAreaUpdate:F=!1})=>{const v={...g,...b};if($(v),v.row!=="header"&&v.column!=="header"&&!F){const oe=ze();P([{point1:v,matcher:oe}]),k(oe)}},[n]),ut=l.useCallback(({type:g})=>{const b={...n};_e({coords:b,updatedValue:{column:g==="Home"?0:r.length-1}}),xe({matcher:void 0,spreadsheetRef:w})},[n,_e,w,r.length]),lt=l.useCallback(g=>Y||g==="Meta"||g==="Control",[Y]),mt=l.useCallback(g=>{event==null||event.preventDefault(),it();const b={...n};let F;switch(g){case"ArrowLeft":{if(b.column==="header")return;typeof b.column=="number"&&(b.column===0?F={column:"header"}:F={column:b.column-1});break}case"ArrowUp":{if(b.row==="header")return;typeof b.row=="number"&&(b.row===0?F={row:"header"}:F={row:b.row-1});break}case"ArrowRight":{if(b.column==="header"&&(F={column:0}),typeof b.column=="number"){if(r.length-1===b.column)return;F={column:b.column+1}}break}case"ArrowDown":{if(b.row==="header"&&(F={row:0}),typeof b.row=="number"){if(se.length-1===b.row)return;F={row:b.row+1}}break}}F&&_e({coords:b,updatedValue:F})},[it,_e,n,r,se]),Ct=l.useCallback(g=>{Wn(g,W,_e,n,Ke,r,se,w,K,He,X,ut,at,st,Be,lt,mt,P,j,k,he,$,C,Me,f)},[W,_e,n,Ke,r,se,w,K,He,X,ut,at,st,Be,lt,mt,f]),dt=()=>{var F,v,oe,De,ft;ee(!0),le(!1);const g=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?se[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null,b=(oe=(v=(F=g==null?void 0:g.row)==null?void 0:F.cells)==null?void 0:v[Number(n==null?void 0:n.column)])==null?void 0:oe.value;de(b||""),te!=null&&te.current&&(te.current.textContent=b),R!=null&&R.current&&(he!=null&&he.current)&&(R.current.style.width=(ft=(De=he==null?void 0:he.current)==null?void 0:De.style)==null?void 0:ft.width)};l.useEffect(()=>{var g,b,F,v,oe,De;Y&&!(_!=null&&_.isEditing)&&((oe=R==null?void 0:R.current)==null||oe.setSelectionRange(Number((b=(g=te==null?void 0:te.current)==null?void 0:g.textContent)==null?void 0:b.length),Number((v=(F=te==null?void 0:te.current)==null?void 0:F.textContent)==null?void 0:v.length)),(De=R==null?void 0:R.current)==null||De.focus())},[Y,_==null?void 0:_.isEditing]);const en=()=>{if((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header"){const g=(n==null?void 0:n.row)==="header"?n==null?void 0:n.column:n==null?void 0:n.row;if((n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)==="header")return;ht({isKeyboard:!1,index:Number(g)})}},tn=()=>{le(!1)},nn=()=>{if((n==null?void 0:n.row)!=="header"||(n==null?void 0:n.column)!=="header"){const g=ze();le(!0),xe({matcher:null,spreadsheetRef:w}),P([{point1:n,matcher:g}]),k(g),j([]),Z(!1)}},rn=g=>{const{key:b}=g;b==="Enter"&&!W&&!f&&((n==null?void 0:n.column)!=="header"&&(n==null?void 0:n.row)!=="header"&&dt(),((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&ht({isKeyboard:!0}))},ht=({isKeyboard:g,index:b=-1})=>{const F={activeCellCoordinates:n,rows:se,columns:r,currentMatcher:K,setActiveCellCoordinates:$,setCurrentMatcher:k,setSelectionAreas:P,spreadsheetRef:w,index:b,isKeyboard:g,setSelectionAreaData:j,isHoldingCommandKey:null,isHoldingShiftKey:null};(n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)!=="header"&&Qe({type:"column",...F}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)!=="header"&&Qe({type:"row",...F}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)==="header"&&Ft({ref:w,setCurrentMatcher:k,setSelectionAreas:P,rows:se,columns:r,activeCellCoordinates:n,updateActiveCellCoordinates:_e})},an=g=>{g||dt()};Tn({isEditing:Y,rows:se,activeCellCoordinates:n,activeCellRef:he,cellEditorRef:R,cellEditorRulerRef:te,visibleColumns:Ge,defaultColumn:je,cellEditorValue:ae});const pt=l.useCallback((g,b)=>{K&&g&&g.length&&b&&K&&P(F=>{const v=me(F),oe=v.findIndex(De=>De.matcher===K);return oe===-1?F:typeof v[oe].point2=="object"&&v[oe].areaCreated?(v[oe].point2=v[oe].point1,v[oe].areaCreated=!1,Z(!1),xe({matcher:K,spreadsheetRef:w}),v):F})},[w,K]),sn=l.useCallback(()=>{pt(X,ie)},[ie,X,pt]);return H.jsx("div",{...q,...Jt(),...Sn(nt),className:ye(ue,e,`${ue}--interactive-cell-element`,{[`${ue}__container-has-focus`]:U,[`${ue}__${D}`]:D==="dark"}),ref:w,role:"grid",tabIndex:0,"aria-rowcount":(se==null?void 0:se.length)||0,"aria-colcount":(r==null?void 0:r.length)||0,"aria-label":y,onKeyDown:Ct,onFocus:()=>C(!0),children:H.jsxs("div",{ref:I,children:[H.jsx(tt,{ref:w,activeCellCoordinates:n,cellSize:t,columns:r,currentMatcher:K,defaultColumn:je,selectedHeaderReorderActive:Se,setSelectedHeaderReorderActive:Ae,headerGroups:ct,rows:se,scrollBarSize:ot,selectionAreas:X,setActiveCellCoordinates:$,setSelectionAreas:P,setCurrentMatcher:k,setSelectionAreaData:j,disableColumnSwapping:p,readOnlyTable:f,totalVisibleColumns:O,updateActiveCellCoordinates:_e,setHeaderCellHoldActive:be,headerCellHoldActive:ge,visibleColumns:Ge,selectAllAriaLabel:u}),H.jsx(et,{activeCellRef:he,activeCellCoordinates:n,setCurrentColumns:M,ref:w,clickAndHoldActive:ie,setClickAndHoldActive:le,currentMatcher:K,setCurrentMatcher:k,setContainerHasFocus:C,selectedHeaderReorderActive:Se,setSelectedHeaderReorderActive:Ae,selectionAreas:X,setSelectionAreas:P,headerGroups:ct,defaultColumn:je,getTableBodyProps:Qt,hasCustomRowHeader:Ze,onDataUpdate:d,renderRowHeaderDirection:A,renderRowHeader:S,onActiveCellChange:i,onSelectionAreaChange:h,prepareRow:Zt,rows:se,selectionAreaData:E,setSelectionAreaData:j,setActiveCellCoordinates:$,scrollBarSize:ot,totalColumnsWidth:Yt,id:m,columns:r,defaultEmptyRowCount:s,setActiveCellInsideSelectionArea:Z,totalVisibleColumns:O,setHeaderCellHoldActive:be,setColumnOrder:Gt,visibleColumns:Ge}),H.jsx("button",{onMouseDown:nn,onMouseUp:tn,onClick:en,onKeyDown:rn,onDoubleClick:()=>an(f),onMouseEnter:sn,ref:he,className:ye(`${ue}--interactive-cell-element`,`${ue}__active-cell--highlight`,{[`${ue}__active-cell--with-selection`]:W}),type:"button",children:fe}),H.jsx("textarea",{id:`${ue}__cell-editor-text-area`,value:ae,onKeyDown:zn({activeCellCoordinates:n,cellEditorRulerRef:te,columns:r,previousState:_,removeCellEditor:He,rows:se,setActiveCellCoordinates:$,setCurrentMatcher:k,setSelectionAreas:P,spreadsheetRef:w,updateData:Be}),onChange:g=>{_.isEditing&&(de(g.target.value),te!=null&&te.current&&(te.current.textContent=g.target.value))},ref:R,"aria-labelledby":n?`${ue}__cell--${n==null?void 0:n.row}--${n==null?void 0:n.column}`:"",className:ye(`${ue}__cell-editor`,`${ue}--interactive-cell-element`,`${ue}__cell-editor--${t}`,{[`${ue}__cell-editor--active`]:Y})}),H.jsx("pre",{"aria-hidden":!0,ref:te,className:`${ue}__cell-editor-ruler`})]})})});pe=we.checkComponentEnabled(pe,nt);pe.displayName=nt;pe.propTypes={cellSize:o.oneOf(["xs","sm","md","lg"]),className:o.string,columns:o.arrayOf(o.shape({Header:o.string,accessor:o.oneOfType([o.string,o.func]),Cell:o.func})),data:o.arrayOf(o.shape),defaultEmptyRowCount:o.number,disableColumnSwapping:o.bool,hasCustomRowHeader:o.bool,id:o.oneOfType([o.number,o.string]),onActiveCellChange:o.func,onColDrag:o.func,onDataUpdate:o.func,onSelectionAreaChange:o.func,readOnlyTable:o.bool,renderRowHeader:o.func,renderRowHeaderDirection:o.oneOf(["left","right"]),selectAllAriaLabel:o.string.isRequired,spreadsheetAriaLabel:o.string.isRequired,theme:o.oneOf(["light","dark"]),totalVisibleColumns:o.number};pe.__docgenInfo={description:"DataSpreadsheet: used to organize and display large amounts of structured data, separated by columns and rows in a grid-like format.",methods:[],displayName:"DataSpreadsheet",props:{cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",defaultValue:{value:"'sm'",computed:!1},type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},className:{required:!1,tsType:{name:"string"},description:"Provide an optional class to be applied to the containing node.",type:{name:"string"}},columns:{required:!1,tsType:{name:"unknown"},description:"The data that will build the column headers",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:{Header:{name:"string",required:!1},accessor:{name:"union",value:[{name:"string"},{name:"func"}],required:!1},Cell:{name:"func",required:!1}}}}},disableColumnSwapping:{required:!1,tsType:{name:"boolean"},description:"Disable column swapping, default false",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},data:{required:!1,tsType:{name:"unknown"},description:"The spreadsheet data that will be rendered in the body of the spreadsheet component",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:"",computed:!0}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",defaultValue:{value:"16",computed:!1},type:{name:"number"}},hasCustomRowHeader:{required:!1,tsType:{name:"boolean"},description:"Check if has custom row header component attached",type:{name:"bool"}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onColDrag:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"Callback for columns after being dragged",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The setter fn for the data prop",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the selection area values change",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},readOnlyTable:{required:!1,tsType:{name:"boolean"},description:"Read-only table",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},renderRowHeaderDirection:{required:!1,tsType:{name:"union",raw:"'left' | 'right'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"}]},description:"Position of the custom row numbering component",type:{name:"enum",value:[{value:"'left'",computed:!1},{value:"'right'",computed:!1}]}},renderRowHeader:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => any[]",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"Array",elements:[{name:"any"}],raw:"any[]"}}},description:"Component next to numbering rows",type:{name:"func"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},spreadsheetAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Data spreadsheet component",type:{name:"string"}},theme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"The theme the DataSpreadsheet should use (only used to render active cell/selection area colors on dark theme)",type:{name:"enum",value:[{value:"'light'",computed:!1},{value:"'dark'",computed:!1}]}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}}}};const xt=["dog","cat","bird","lizard","frog","hamster","fish","rabbit","snake"],Fe=["Bruno","Willow","Kona","Heidi","Rusty","Bonnie","Cash","Gucci","Brody","Emma","Loki","Angel","Astro","Sherman","Layla","Peanut","Grace","Mickey","Sasha","Finn","Tucker","Bear","Mocha","Roscoe"],Un=t=>{const e=[];for(let r=0;r<t;r++)e.push(r);return e},Kn=t=>{const e=t&&{ownerName:Fe[Math.floor(Math.random()*Fe.length)],weight:Math.floor(Math.random()*40)},r={petType:xt[Math.floor(Math.random()*xt.length)],firstName:Fe[Math.floor(Math.random()*Fe.length)],age:Math.floor(Math.random()*30),visits:Math.floor(Math.random()*40),health:Math.floor(Math.random()*100)};return t?{...r,...e}:r},Ve=({rows:t,extraColumns:e})=>((a=0)=>{const d=[t][a];return Un(d).map(()=>({...Kn(e)}))})();function St(t){const e={a:"a",h1:"h1",h2:"h2",li:"li",ul:"ul",...Kt(),...t.components};return H.jsxs(H.Fragment,{children:[H.jsx(e.h1,{id:"dataspreadsheet",children:"DataSpreadsheet"}),`
`,H.jsx(e.h2,{id:"table-of-contents",children:"Table of Contents"}),`
`,H.jsxs(e.ul,{children:[`
`,H.jsx(e.li,{children:H.jsx(e.a,{href:"#overview",children:"Overview"})}),`
`,H.jsx(e.li,{children:H.jsx(e.a,{href:"#example-usage",children:"Example usage"})}),`
`,H.jsx(e.li,{children:H.jsx(e.a,{href:"#component-api",children:"Component API"})}),`
`]}),`
`,H.jsx(e.h2,{id:"overview",children:"Overview"}),`
`,`
`,H.jsx(e.h2,{id:"example-usage",children:"Example usage"}),`
`,`
`,H.jsx(cn,{children:H.jsx(un,{of:Ie})}),`
`,H.jsx(e.h2,{id:"code-sample",children:"Code sample"}),`
`,`
`,H.jsx(e.h2,{id:"component-api",children:"Component API"}),`
`,H.jsx(ln,{})]})}function Fn(t={}){const{wrapper:e}={...Kt(),...t.components};return e?H.jsx(e,{...t,children:H.jsx(St,{...t})}):St(t)}const Rn="div[data-story-title*=DataSpreadsheet] .docs-story>div:first-child>div:first-child{overflow:auto;width:100%}",jr={title:"Experimental/Components/Data spreadsheet/DataSpreadsheet",component:pe,tags:["autodocs"],argTypes:{onActiveCellChange:{action:"active cell change"},onColDrag:{action:"on column drag"},onSelectionAreaChange:{action:"selection area change"}},parameters:{styles:Rn,docs:{page:Fn}}},Re=({value:t})=>H.jsx("span",{style:{display:"flex",justifyContent:"flex-end"},children:t}),qe=[{Header:"Row Index",accessor:(t,e)=>e,Cell:({cell:{value:t}})=>H.jsx(Re,{value:t}),placement:"right",width:275},{Header:"Pet type",accessor:"petType"},{Header:"First Name",accessor:"firstName"},{Header:"Age",accessor:"age",Cell:({cell:{value:t}})=>H.jsx(Re,{value:t}),placement:"right"},{Header:"Vet visits",accessor:"visits",Cell:({cell:{value:t}})=>H.jsx(Re,{value:t}),placement:"right"},{Header:"Health",accessor:"health",Cell:({cell:{value:t}})=>H.jsx(Re,{value:t}),placement:"right"}],Xn=({...t})=>{const[e,r]=l.useState(()=>Ve({rows:16})),a=l.useMemo(()=>qe,[]);return H.jsx(pe,{columns:a,data:e,onDataUpdate:r,id:"spreadsheet--id",...t})},Jn=({...t})=>{const[e,r]=l.useState(()=>Ve({rows:1e5})),a=l.useMemo(()=>qe,[]),s=d=>H.jsx(mn,{style:{width:"32px",height:"32px",minWidth:"32px",minHeight:"32px"},children:H.jsx(dn,{itemText:`Test item ${d}`})});return H.jsx(pe,{columns:a,data:e,onDataUpdate:r,renderRowHeaderDirection:"Left",renderRowHeader:s,id:"spreadsheet--id",...t})},Qn=({...t})=>{const[e,r]=l.useState(()=>Ve({rows:1e3})),a=l.useMemo(()=>qe,[]);return H.jsx(pe,{columns:a,data:e,onDataUpdate:r,id:"spreadsheet--id",...t})},Yn=({...t})=>{const[e,r]=l.useState([]),a=l.useMemo(()=>[...qe.filter(d=>d.Header!=="Row Index")],[]),s=l.useMemo(()=>a,[a]);return H.jsx(pe,{columns:s,data:e,onDataUpdate:r,id:"spreadsheet--id",...t})},Zn=({...t})=>{const[e,r]=l.useState(()=>Ve({rows:24,extraColumns:!0})),a=l.useMemo(()=>[...qe,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=l.useMemo(()=>a,[a]);return H.jsx(pe,{columns:s,data:e,onDataUpdate:r,id:"spreadsheet--id",...t})},Gn=({...t})=>{const[e,r]=l.useState(()=>Ve({rows:24,extraColumns:!0})),a=l.useMemo(()=>[...qe,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=l.useMemo(()=>a,[a]);return H.jsx(pe,{columns:s,data:e,onDataUpdate:r,id:"spreadsheet--id",...t})},vn=({...t})=>{const[e,r]=l.useState(()=>Ve({rows:24,extraColumns:!0})),a=c=>{},s=l.useMemo(()=>[...qe,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),d=l.useMemo(()=>s,[s]);return H.jsx(pe,{columns:d,data:e,onDataUpdate:r,onColDrag:a,id:"spreadsheet--id",...t})},Ie=Xn.bind({});Ie.storyName="Basic spreadsheet";Ie.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Oe=Qn.bind({});Oe.storyName="Large dataset";Oe.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const ke=Jn.bind({});ke.storyName="Large dataset with optional component";ke.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Le=Yn.bind({});Le.storyName="Empty with cells";Le.args={defaultEmptyRowCount:24,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Ne=Zn.bind({});Ne.storyName="With many columns";Ne.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};const Pe=Gn.bind({});Pe.storyName="With different options";Pe.args={readOnlyTable:!1,disableColumnSwapping:!1,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};const We=vn.bind({});We.storyName="With drag drop  callback";We.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};var Dt,At,_t;Ie.parameters={...Ie.parameters,docs:{...(Dt=Ie.parameters)==null?void 0:Dt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 16
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(_t=(At=Ie.parameters)==null?void 0:At.docs)==null?void 0:_t.source}}};var Ht,Tt,It;Oe.parameters={...Oe.parameters,docs:{...(Ht=Oe.parameters)==null?void 0:Ht.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 1000
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(It=(Tt=Oe.parameters)==null?void 0:Tt.docs)==null?void 0:It.source}}};var $t,qt,Mt;ke.parameters={...ke.parameters,docs:{...($t=ke.parameters)==null?void 0:$t.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 100000
  }));
  const columns = useMemo(() => columnData, []);
  const buildComponent = index => <OverflowMenu style={{
    width: '32px',
    height: '32px',
    minWidth: '32px',
    minHeight: '32px'
  }}>
      <OverflowMenuItem itemText={\`Test item \${index}\`} />
    </OverflowMenu>;
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} renderRowHeaderDirection="Left" renderRowHeader={buildComponent} id="spreadsheet--id" {...args} />;
}`,...(Mt=(qt=ke.parameters)==null?void 0:qt.docs)==null?void 0:Mt.source}}};var jt,Ot,kt;Le.parameters={...Le.parameters,docs:{...(jt=Le.parameters)==null?void 0:jt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState([]);
  const columnDataClone = useMemo(() => [...columnData.filter(item => item.Header !== 'Row Index')], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(kt=(Ot=Le.parameters)==null?void 0:Ot.docs)==null?void 0:kt.source}}};var Lt,Nt,Pt;Ne.parameters={...Ne.parameters,docs:{...(Lt=Ne.parameters)==null?void 0:Lt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Pt=(Nt=Ne.parameters)==null?void 0:Nt.docs)==null?void 0:Pt.source}}};var Wt,Vt,Bt;Pe.parameters={...Pe.parameters,docs:{...(Wt=Pe.parameters)==null?void 0:Wt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(Bt=(Vt=Pe.parameters)==null?void 0:Vt.docs)==null?void 0:Bt.source}}};var Et,zt,Ut;We.parameters={...We.parameters,docs:{...(Et=We.parameters)==null?void 0:Et.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const onColumnDragDrop = tableData => {
    // Dev can debug here
  };
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} onColDrag={onColumnDragDrop} id="spreadsheet--id" {...args} />;
}`,...(Ut=(zt=We.parameters)==null?void 0:zt.docs)==null?void 0:Ut.source}}};const Or=["dataSpreadsheet","largeDatasetSpreadsheet","largeDatasetSpreadsheetCustom","emptyWithCells","withManyColumns","withDifferentOptions","withDragDropCallback"];export{Or as __namedExportsOrder,Ie as dataSpreadsheet,jr as default,Le as emptyWithCells,Oe as largeDatasetSpreadsheet,ke as largeDatasetSpreadsheetCustom,Pe as withDifferentOptions,We as withDragDropCallback,Ne as withManyColumns};
