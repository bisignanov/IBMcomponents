import{p as Ne,u as Le,f as ke,c as N,_ as C,e as oe,s as Me,q as Be,r as ze}from"./floating-ui.react-C-lGofMW.js";import{R as s,r as E}from"./index-BwDkhjyp.js";import{u as de,L,a as He,b as qe}from"./index-B1Zk_jvd.js";import{P as n}from"./index-Dk74W0Oi.js";import{m as Ke}from"./mergeRefs-CTUecegF.js";import{F as We}from"./FormContext-C7kRVu4t.js";import{b as Ue,a as Ve}from"./bucket-18-9qioxFta.js";import{b as Ge}from"./events-B5D95Jtx.js";const Je=["top","right","bottom","left"];function ce(e,l){return typeof e=="function"?e(l):e}function Qe(e){return{top:0,right:0,bottom:0,left:0,...e}}function Xe(e){return typeof e!="number"?Qe(e):{top:e,right:e,bottom:e,left:e}}function ie(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function le(e,l){var a;l===void 0&&(l={});const{x:T,y:p,platform:i,rects:d,elements:_,strategy:R}=e,{boundary:k="clippingAncestors",rootBoundary:m="viewport",elementContext:v="floating",altBoundary:P=!1,padding:M=0}=ce(l,e),g=Xe(M),O=_[P?v==="floating"?"reference":"floating":v],b=ie(await i.getClippingRect({element:(a=await(i.isElement==null?void 0:i.isElement(O)))==null||a?O:O.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(_.floating)),boundary:k,rootBoundary:m,strategy:R})),A=v==="floating"?{...d.floating,x:T,y:p}:d.reference,h=await(i.getOffsetParent==null?void 0:i.getOffsetParent(_.floating)),$=await(i.isElement==null?void 0:i.isElement(h))?await(i.getScale==null?void 0:i.getScale(h))||{x:1,y:1}:{x:1,y:1},w=ie(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:A,offsetParent:h,strategy:R}):A);return{top:(b.top-w.top+g.top)/$.y,bottom:(w.bottom-b.bottom+g.bottom)/$.y,left:(b.left-w.left+g.left)/$.x,right:(w.right-b.right+g.right)/$.x}}function re(e,l){return{top:e.top-l.height,right:e.right-l.width,bottom:e.bottom-l.height,left:e.left-l.width}}function se(e){return Je.some(l=>e[l]>=0)}const Ye=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(l){const{rects:a}=l,{strategy:T="referenceHidden",...p}=ce(e,l);switch(T){case"referenceHidden":{const i=await le(l,{...p,elementContext:"reference"}),d=re(i,a.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:se(d)}}}case"escaped":{const i=await le(l,{...p,altBoundary:!0}),d=re(i,a.floating);return{data:{escapedOffsets:d,escaped:se(d)}}}default:return{}}}}},{ItemMouseMove:Ze,MenuMouseLeave:et}=de.stateChangeTypes,ae=e=>typeof e=="string"?e:typeof e=="number"?`${e}`:e!==null&&typeof e=="object"&&"label"in e&&typeof e.label=="string"?e.label:"",fe=s.forwardRef((e,l)=>{var ne;let{autoAlign:a=!1,className:T,disabled:p=!1,direction:i="bottom",items:d,label:_,["aria-label"]:R,ariaLabel:k,itemToString:m=ae,itemToElement:v=null,renderSelectedItem:P,type:M="default",size:g,onChange:B,id:O,titleText:b="",hideLabel:A,helperText:h="",translateWithId:$,light:w,invalid:u,invalidText:pe,warn:j,warnText:ue,initialSelectedItem:me,selectedItem:W,downshiftProps:ge,readOnly:z,slug:D,...be}=e;const{refs:I,floatingStyles:U,middlewareData:he}=Ne(a?{placement:i,strategy:"fixed",middleware:[Me({apply(t){let{rects:r,elements:c}=t;Object.assign(c.floating.style,{width:`${r.reference.width}px`})}}),Be(),Ye()],whileElementsMounted:ze}:{});E.useEffect(()=>{var t;if(a){const r={...U,visibility:(t=he.hide)!=null&&t.referenceHidden?"hidden":"visible"};Object.keys(r).forEach(c=>{I.floating.current&&(I.floating.current.style[c]=r[c])})}},[U,a,I.floating]);const o=Le(),{isFluid:H}=E.useContext(We),V={items:d,itemToString:m,initialSelectedItem:me,onSelectedItemChange:Re,stateReducer:ye,isItemDisabled(t,r){return t!==null&&typeof t=="object"&&"disabled"in t&&t.disabled===!0},onHighlightedIndexChange:t=>{let{highlightedIndex:r}=t;if(r>-1&&typeof window!==void 0){const f=document.querySelectorAll(`li.${o}--list-box__menu-item[role="option"]`)[r];f&&f.scrollIntoView({behavior:"smooth",block:"nearest"})}},...ge},we=ke();function ye(t,r){const{changes:c,type:f}=r;switch(f){case Ze:case et:return{...c,highlightedIndex:t.highlightedIndex}}return c}W!==void 0&&(V.selectedItem=W);const{isOpen:S,getToggleButtonProps:xe,getLabelProps:_e,getMenuProps:G,getItemProps:ve,selectedItem:y,highlightedIndex:$e}=de(V),x=M==="inline",J=!u&&j,[Ie,Ee]=E.useState(!1),Te=N(`${o}--dropdown`,{[`${o}--dropdown--invalid`]:u,[`${o}--dropdown--warning`]:J,[`${o}--dropdown--open`]:S,[`${o}--dropdown--inline`]:x,[`${o}--dropdown--disabled`]:p,[`${o}--dropdown--light`]:w,[`${o}--dropdown--readonly`]:z,[`${o}--dropdown--${g}`]:g,[`${o}--list-box--up`]:i==="top",[`${o}--dropdown--autoalign`]:a}),Oe=N(`${o}--label`,{[`${o}--label--disabled`]:p,[`${o}--visually-hidden`]:A}),Se=N(`${o}--form__helper-text`,{[`${o}--form__helper-text--disabled`]:p}),Ce=N(`${o}--dropdown__wrapper`,`${o}--list-box__wrapper`,T,{[`${o}--dropdown__wrapper--inline`]:x,[`${o}--list-box__wrapper--inline`]:x,[`${o}--dropdown__wrapper--inline--invalid`]:x&&u,[`${o}--list-box__wrapper--inline--invalid`]:x&&u,[`${o}--list-box__wrapper--fluid--invalid`]:H&&u,[`${o}--list-box__wrapper--fluid--focus`]:H&&Ie&&!S,[`${o}--list-box__wrapper--slug`]:D}),Q=h?`dropdown-helper-text-${we}`:void 0,q=v,F=xe(),X=h&&!H?s.createElement("div",{id:Q,className:Se},h):null;function Re(t){let{selectedItem:r}=t;B&&B({selectedItem:r??null})}const Y=t=>{Ee(t.type==="focus")},K=Ke(F.ref,l),[Z,Pe]=E.useState();let[Ae,ee]=E.useState(!1);const je=z?{onClick:t=>{t.preventDefault(),K.current!==void 0&&K.current.focus()},onKeyDown:t=>{["ArrowDown","ArrowUp"," ","Enter"].includes(t.key)&&t.preventDefault()}}:{onKeyDown:t=>{(t.code!=="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(t.key))&&ee(!0),(Ae&&t.code==="Space"||!["ArrowDown","ArrowUp"," ","Enter"].includes(t.key))&&(Z&&clearTimeout(Z),Pe(setTimeout(()=>{ee(!1)},3e3))),F.onKeyDown&&F.onKeyDown(t)}},De=E.useMemo(()=>G({ref:a?I.setFloating:null}),[a,G,I.setFloating]);let te;return D&&((ne=D.type)==null?void 0:ne.displayName)==="AILabel"&&(te=s.cloneElement(D,{size:"mini"})),s.createElement("div",C({className:Ce},be),b&&s.createElement("label",C({className:Oe},_e()),b),s.createElement(L,{onFocus:Y,onBlur:Y,"aria-label":k||R,size:g,className:Te,invalid:u,invalidText:pe,warn:j,warnText:ue,light:w,isOpen:S,ref:a?I.setReference:null,id:O},u&&s.createElement(Ue,{className:`${o}--list-box__invalid-icon`}),J&&s.createElement(Ve,{className:`${o}--list-box__invalid-icon ${o}--list-box__invalid-icon--warning`}),s.createElement("button",C({type:"button",className:`${o}--list-box__field`,disabled:p,"aria-disabled":z?!0:void 0,"aria-describedby":!x&&!u&&!j&&X?Q:void 0,title:y&&m!==void 0?m(y):ae(_)},F,je,{ref:K}),s.createElement("span",{className:`${o}--list-box__label`},y?P?P(y):m(y):_),s.createElement(L.MenuIcon,{isOpen:S,translateWithId:$})),te,s.createElement(L.Menu,De,S&&d.map((t,r)=>{const c=t!==null&&typeof t=="object",f=ve({item:t,index:r});t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"id")&&(f.id=t.id);const Fe=c&&"text"in t&&v?t.text:m(t);return s.createElement(L.MenuItem,C({key:f.id,isActive:y===t,isHighlighted:$e===r,title:Fe,disabled:f["aria-disabled"]},f),typeof t=="object"&&q!==void 0&&q!==null?s.createElement(q,C({key:f.id},t)):m(t),y===t&&s.createElement(Ge,{className:`${o}--list-box__menu-item__selected-icon`}))}))),!x&&!u&&!j&&X)});fe.displayName="Dropdown";fe.propTypes={"aria-label":n.string,ariaLabel:oe(n.string),autoAlign:n.bool,className:n.string,direction:n.oneOf(["top","bottom"]),disabled:n.bool,downshiftProps:n.object,helperText:n.node,hideLabel:n.bool,id:n.string.isRequired,initialSelectedItem:n.oneOfType([n.object,n.string,n.number]),invalid:n.bool,invalidText:n.node,itemToElement:n.func,itemToString:n.func,items:n.array.isRequired,label:n.node.isRequired,light:oe(n.bool),onChange:n.func,readOnly:n.bool,renderSelectedItem:n.func,selectedItem:n.oneOfType([n.object,n.string,n.number]),size:He,slug:n.node,titleText:n.node.isRequired,translateWithId:n.func,type:qe,warn:n.bool,warnText:n.node};export{fe as D};
