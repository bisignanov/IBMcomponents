import{u as fe,b as pe,g as xe,c as h,_ as ge,d as he,s as be}from"./useMergedRefs-CY5AfkP4.js";import{P as t}from"./index-Dk74W0Oi.js";import{R as r,r as w}from"./index-BwDkhjyp.js";import{F as we}from"./FormContext-C7kRVu4t.js";import{u as _e}from"./useAnnouncer-MW4fVOqQ.js";import{n as E}from"./settings-B0yoEqB-.js";import{T as _}from"./Text-CiWJR74P.js";import{W as K,a as M}from"./bucket-18-CV2-K6tq.js";const $e=be(),j=r.forwardRef((B,G)=>{var q;const{className:H,disabled:u=!1,id:y,labelText:N,hideLabel:J,onChange:I=E,onClick:W=E,onKeyDown:A=E,invalid:n=!1,invalidText:Q="",helperText:$="",light:U,placeholder:X="",enableCounter:b=!1,maxCount:l=void 0,counterMode:c="character",warn:m=!1,warnText:Y="",rows:Z=4,slug:T,...p}=B,e=fe(),{isFluid:s}=w.useContext(we),{defaultValue:D,value:R}=p,{current:ee}=w.useRef($e()),o=w.useRef(null),te=pe([G,o]);function F(){var f,g;const d=(D||R||((f=o.current)==null?void 0:f.value)||"").toString();return c==="character"?d.length:((g=d.match(/\w+/g))==null?void 0:g.length)||0}const[v,x]=w.useState(F());w.useEffect(()=>{x(F())},[R,D,c]),xe(()=>{p.cols&&o.current?(o.current.style.width="",o.current.style.resize="none"):o.current&&(o.current.style.width="100%")},[p.cols]);const O={id:y,onKeyDown:a=>{if(!u&&b&&c==="word"){const d=a.which;l&&v>=l&&d===32&&a.preventDefault()}!u&&A&&A(a)},onPaste:a=>{if(!u&&c==="word"&&b&&typeof l<"u"&&o.current!==null){const d=o.current.value.match(/\w+/g)||[],f=a.clipboardData.getData("Text").match(/\w+/g)||[];if(d.length+f.length>l){a.preventDefault();const i=d.concat(f).slice(0,l);setTimeout(()=>{x(l)},0),o.current.value=i.join(" ")}}},onChange:a=>{var d,f,g;if(!u){if(c=="character")(d=a==null?void 0:a.persist)==null||d.call(a),setTimeout(()=>{var i,z;x((z=(i=a.target)==null?void 0:i.value)==null?void 0:z.length)},0);else if(c=="word"){if(!a.target.value){setTimeout(()=>{x(0)},0);return}if(b&&typeof l<"u"&&o.current!==null){const i=(g=(f=a.target)==null?void 0:f.value)==null?void 0:g.match(/\w+/g);i&&i.length<=l?(o.current.removeAttribute("maxLength"),setTimeout(()=>{x(i.length)},0)):i&&i.length>l&&setTimeout(()=>{x(i.length)},0)}}I&&I(a)}},onClick:a=>{!u&&W&&W(a)}},ae=h(`${e}--form-item`,H),re=h(`${e}--text-area__wrapper`,{[`${e}--text-area__wrapper--cols`]:p.cols,[`${e}--text-area__wrapper--readonly`]:p.readOnly,[`${e}--text-area__wrapper--warn`]:m,[`${e}--text-area__wrapper--slug`]:T}),ne=h(`${e}--label`,{[`${e}--visually-hidden`]:J&&!s,[`${e}--label--disabled`]:u}),le=h(`${e}--text-area`,{[`${e}--text-area--light`]:U,[`${e}--text-area--invalid`]:n,[`${e}--text-area--warn`]:m}),se=h(`${e}--label`,{[`${e}--label--disabled`]:u}),oe=h(`${e}--form__helper-text`,{[`${e}--form__helper-text--disabled`]:u}),ie=N?r.createElement(_,{as:"label",htmlFor:y,className:ne},N):null,ce=b&&l&&(c==="character"||c==="word")?r.createElement(_,{as:"div",className:se},`${v}/${l}`):null,P=$?`text-area-helper-text-${ee}`:void 0,de=$?r.createElement(_,{as:"div",id:P,className:oe},$):null,V=y+"-error-msg",k=n?r.createElement(_,{as:"div",role:"alert",className:`${e}--form-requirement`,id:V},Q,s&&r.createElement(K,{className:`${e}--text-area__invalid-icon`})):null,L=m?r.createElement(_,{as:"div",role:"alert",className:`${e}--form-requirement`},Y,s&&r.createElement(M,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`})):null;let C;n?C=V:!n&&!m&&!s&&$&&(C=P),b&&c=="character"&&(O.maxLength=l);const ue=_e(v,l,c==="word"?"words":void 0),me=r.createElement("textarea",ge({},p,O,{placeholder:X,className:le,"aria-invalid":n,"aria-describedby":C,disabled:u,rows:Z,readOnly:p.readOnly,ref:te}));let S;return T&&((q=T.type)==null?void 0:q.displayName)==="Slug"&&(S=r.cloneElement(T,{size:"mini"})),r.createElement("div",{className:ae},r.createElement("div",{className:`${e}--text-area__label-wrapper`},ie,ce),r.createElement("div",{className:re,"data-invalid":n||null},n&&!s&&r.createElement(K,{className:`${e}--text-area__invalid-icon`}),m&&!n&&!s&&r.createElement(M,{className:`${e}--text-area__invalid-icon ${e}--text-area__invalid-icon--warning`}),me,S,r.createElement("span",{className:`${e}--text-area__counter-alert`,role:"alert"},ue),s&&r.createElement("hr",{className:`${e}--text-area__divider`}),s&&n?k:null,s&&m&&!n?L:null),!n&&!m&&!s?de:null,n&&!s?k:null,m&&!n&&!s?L:null)});j.displayName="TextArea";j.propTypes={className:t.string,cols:t.number,counterMode:t.oneOf(["character","word"]),defaultValue:t.oneOfType([t.string,t.number]),disabled:t.bool,enableCounter:t.bool,helperText:t.node,hideLabel:t.bool,id:t.string,invalid:t.bool,invalidText:t.node,labelText:t.node.isRequired,light:he(t.bool),maxCount:t.number,onChange:t.func,onClick:t.func,onKeyDown:t.func,placeholder:t.string,readOnly:t.bool,rows:t.number,slug:t.node,value:t.oneOfType([t.string,t.number]),warn:t.bool,warnText:t.node};export{j as T};
